!--------------------------------------------------------------------------------------------------
!     Copyright (c) CERFACS (all rights reserved)
!--------------------------------------------------------------------------------------------------
!     FILE ./database/S18R151QSS14_0/S18R151QSS14_0.f90
!>    @file ./database/S18R151QSS14_0/S18R151QSS14_0.f90
!!    Module for calculating the analytical source terms in Cantera
!!    @details 
!!    @authors 
!!    @date    2024/02/16
!!    @since   
!!    @note    
!--------------------------------------------------------------------------------------------------

!--------------------------------------------------------------------------------------------------
!     MODULE mod_customkinetics
!>    @details Generated by ARCANE custom kinetics routine to compute the chemical source terms.
!!    @authors Q. Caz√®res, P. Pepiot
!!    @date    2019/01/24
!--------------------------------------------------------------------------------------------------
module mod_customkinetics
  implicit none

  integer, parameter :: pr = selected_real_kind(15,307)

  ! Ideal gas constant
  real(pr), parameter :: Rcst = 8.3144621_pr
  
  ! Use semi-implicit formulation for select species
  logical, parameter :: semiImplicit = .False.
  
  ! Number of elements in the chemical system 
  integer, parameter :: ne = 4
  
  ! Number of non-qss and qss species and reactions
  integer, parameter :: nspec = 18
  integer, parameter :: nqss = 14
  integer, parameter :: nreac = 151
  integer, parameter :: nreac_reverse = 132
  
  ! Actual expression of each reaction
  character(len=65), dimension(nreac + nreac_reverse) :: reacexp
  
  ! Number of thirdbodies
  integer, parameter :: nTB = 6
  integer, parameter :: nFO = 17
  integer, parameter :: nTB_reverse = 5
  integer, parameter :: nFO_reverse = 17
  
  ! Index of elements
  integer, parameter :: eN = 1
  integer, parameter :: eH = 2
  integer, parameter :: eO = 3
  integer, parameter :: eC = 4

  ! Index of species
  integer, parameter :: sN2 = 1
  integer, parameter :: sH2 = 2
  integer, parameter :: sH = 3
  integer, parameter :: sO2 = 4
  integer, parameter :: sO = 5
  integer, parameter :: sH2O = 6
  integer, parameter :: sOH = 7
  integer, parameter :: sCO = 8
  integer, parameter :: sCO2 = 9
  integer, parameter :: sCH4 = 10
  integer, parameter :: sCH3 = 11
  integer, parameter :: sCH2O = 12
  integer, parameter :: sC2H6 = 13
  integer, parameter :: sHO2 = 14
  integer, parameter :: sC2H4 = 15
  integer, parameter :: sNO = 16
  integer, parameter :: sN2O = 17
  integer, parameter :: sNO2 = 18

  integer, parameter :: sqssC2H2 = 1
  integer, parameter :: sqssCH2GL1G = 2
  integer, parameter :: sqssCH3OH = 3
  integer, parameter :: sqssCH3O = 4
  integer, parameter :: sqssCH2OH = 5
  integer, parameter :: sqssHCO = 6
  integer, parameter :: sqssC2H5 = 7
  integer, parameter :: sqssC2H3 = 8
  integer, parameter :: sqssCH2CO = 9
  integer, parameter :: sqssHNO = 10
  integer, parameter :: sqssN = 11
  integer, parameter :: sqssN2H = 12
  integer, parameter :: sqssNH2 = 13
  integer, parameter :: sqssNH = 14

  ! Index of reactions
  integer, parameter :: r1f = 1
  integer, parameter :: r2f = 2
  integer, parameter :: r3f = 3
  integer, parameter :: r4f = 4
  integer, parameter :: r5f = 5
  integer, parameter :: r6f = 6
  integer, parameter :: r7f = 7
  integer, parameter :: r8f = 8
  integer, parameter :: r9f = 9
  integer, parameter :: r10f = 10
  integer, parameter :: r11f = 11
  integer, parameter :: r12f = 12
  integer, parameter :: r13f = 13
  integer, parameter :: r14f = 14
  integer, parameter :: r15f = 15
  integer, parameter :: r16f = 16
  integer, parameter :: r17f = 17
  integer, parameter :: r18f = 18
  integer, parameter :: r19f = 19
  integer, parameter :: r20f = 20
  integer, parameter :: r21f = 21
  integer, parameter :: r22f = 22
  integer, parameter :: r23f = 23
  integer, parameter :: r24f = 24
  integer, parameter :: r25f = 25
  integer, parameter :: r26f = 26
  integer, parameter :: r27f = 27
  integer, parameter :: r28f = 28
  integer, parameter :: r29f = 29
  integer, parameter :: r30f = 30
  integer, parameter :: r31f = 31
  integer, parameter :: r32f = 32
  integer, parameter :: r33f = 33
  integer, parameter :: r34f = 34
  integer, parameter :: r35f = 35
  integer, parameter :: r36f = 36
  integer, parameter :: r37f = 37
  integer, parameter :: r38f = 38
  integer, parameter :: r39f = 39
  integer, parameter :: r40f = 40
  integer, parameter :: r41f = 41
  integer, parameter :: r42f = 42
  integer, parameter :: r43f = 43
  integer, parameter :: r44f = 44
  integer, parameter :: r45f = 45
  integer, parameter :: r46f = 46
  integer, parameter :: r47f = 47
  integer, parameter :: r48f = 48
  integer, parameter :: r49f = 49
  integer, parameter :: r50f = 50
  integer, parameter :: r51f = 51
  integer, parameter :: r52f = 52
  integer, parameter :: r53f = 53
  integer, parameter :: r54f = 54
  integer, parameter :: r55f = 55
  integer, parameter :: r56f = 56
  integer, parameter :: r57f = 57
  integer, parameter :: r58f = 58
  integer, parameter :: r59f = 59
  integer, parameter :: r60f = 60
  integer, parameter :: r61f = 61
  integer, parameter :: r62f = 62
  integer, parameter :: r63f = 63
  integer, parameter :: r64f = 64
  integer, parameter :: r65f = 65
  integer, parameter :: r66f = 66
  integer, parameter :: r67f = 67
  integer, parameter :: r68f = 68
  integer, parameter :: r69f = 69
  integer, parameter :: r70f = 70
  integer, parameter :: r71f = 71
  integer, parameter :: r72f = 72
  integer, parameter :: r73f = 73
  integer, parameter :: r74f = 74
  integer, parameter :: r75f = 75
  integer, parameter :: r76f = 76
  integer, parameter :: r77f = 77
  integer, parameter :: r78f = 78
  integer, parameter :: r79f = 79
  integer, parameter :: r80f = 80
  integer, parameter :: r81f = 81
  integer, parameter :: r82f = 82
  integer, parameter :: r83f = 83
  integer, parameter :: r84f = 84
  integer, parameter :: r85f = 85
  integer, parameter :: r86f = 86
  integer, parameter :: r87f = 87
  integer, parameter :: r88f = 88
  integer, parameter :: r89f = 89
  integer, parameter :: r90f = 90
  integer, parameter :: r91f = 91
  integer, parameter :: r92f = 92
  integer, parameter :: r93f = 93
  integer, parameter :: r94f = 94
  integer, parameter :: r95f = 95
  integer, parameter :: r96f = 96
  integer, parameter :: r97f = 97
  integer, parameter :: r98f = 98
  integer, parameter :: r99f = 99
  integer, parameter :: r100f = 100
  integer, parameter :: r101f = 101
  integer, parameter :: r102f = 102
  integer, parameter :: r103f = 103
  integer, parameter :: r104f = 104
  integer, parameter :: r105f = 105
  integer, parameter :: r106f = 106
  integer, parameter :: r107f = 107
  integer, parameter :: r108f = 108
  integer, parameter :: r109f = 109
  integer, parameter :: r110f = 110
  integer, parameter :: r111f = 111
  integer, parameter :: r112f = 112
  integer, parameter :: r113f = 113
  integer, parameter :: r114f = 114
  integer, parameter :: r115f = 115
  integer, parameter :: r116f = 116
  integer, parameter :: r117f = 117
  integer, parameter :: r118f = 118
  integer, parameter :: r119f = 119
  integer, parameter :: r120f = 120
  integer, parameter :: r121f = 121
  integer, parameter :: r122f = 122
  integer, parameter :: r123f = 123
  integer, parameter :: r124f = 124
  integer, parameter :: r125f = 125
  integer, parameter :: r126f = 126
  integer, parameter :: r127f = 127
  integer, parameter :: r128f = 128
  integer, parameter :: r129f = 129
  integer, parameter :: r130f = 130
  integer, parameter :: r131f = 131
  integer, parameter :: r132f = 132
  integer, parameter :: r133f = 133
  integer, parameter :: r134f = 134
  integer, parameter :: r135f = 135
  integer, parameter :: r136f = 136
  integer, parameter :: r137f = 137
  integer, parameter :: r138f = 138
  integer, parameter :: r139f = 139
  integer, parameter :: r140f = 140
  integer, parameter :: r141f = 141
  integer, parameter :: r142f = 142
  integer, parameter :: r143f = 143
  integer, parameter :: r144f = 144
  integer, parameter :: r145f = 145
  integer, parameter :: r146f = 146
  integer, parameter :: r147f = 147
  integer, parameter :: r148f = 148
  integer, parameter :: r149f = 149
  integer, parameter :: r150f = 150
  integer, parameter :: r151f = 151
  integer, parameter :: r1b = 152
  integer, parameter :: r2b = 153
  integer, parameter :: r3b = 154
  integer, parameter :: r4b = 155
  integer, parameter :: r5b = 156
  integer, parameter :: r6b = 157
  integer, parameter :: r7b = 158
  integer, parameter :: r8b = 159
  integer, parameter :: r9b = 160
  integer, parameter :: r10b = 161
  integer, parameter :: r11b = 162
  integer, parameter :: r12b = 163
  integer, parameter :: r13b = 164
  integer, parameter :: r14b = 165
  integer, parameter :: r15b = 166
  integer, parameter :: r16b = 167
  integer, parameter :: r17b = 168
  integer, parameter :: r18b = 169
  integer, parameter :: r19b = 170
  integer, parameter :: r20b = 171
  integer, parameter :: r22b = 172
  integer, parameter :: r23b = 173
  integer, parameter :: r24b = 174
  integer, parameter :: r25b = 175
  integer, parameter :: r26b = 176
  integer, parameter :: r27b = 177
  integer, parameter :: r28b = 178
  integer, parameter :: r29b = 179
  integer, parameter :: r32b = 180
  integer, parameter :: r33b = 181
  integer, parameter :: r34b = 182
  integer, parameter :: r35b = 183
  integer, parameter :: r36b = 184
  integer, parameter :: r37b = 185
  integer, parameter :: r38b = 186
  integer, parameter :: r39b = 187
  integer, parameter :: r40b = 188
  integer, parameter :: r41b = 189
  integer, parameter :: r42b = 190
  integer, parameter :: r43b = 191
  integer, parameter :: r44b = 192
  integer, parameter :: r45b = 193
  integer, parameter :: r46b = 194
  integer, parameter :: r47b = 195
  integer, parameter :: r48b = 196
  integer, parameter :: r49b = 197
  integer, parameter :: r50b = 198
  integer, parameter :: r51b = 199
  integer, parameter :: r52b = 200
  integer, parameter :: r53b = 201
  integer, parameter :: r54b = 202
  integer, parameter :: r55b = 203
  integer, parameter :: r56b = 204
  integer, parameter :: r57b = 205
  integer, parameter :: r58b = 206
  integer, parameter :: r59b = 207
  integer, parameter :: r60b = 208
  integer, parameter :: r61b = 209
  integer, parameter :: r62b = 210
  integer, parameter :: r63b = 211
  integer, parameter :: r64b = 212
  integer, parameter :: r65b = 213
  integer, parameter :: r66b = 214
  integer, parameter :: r67b = 215
  integer, parameter :: r68b = 216
  integer, parameter :: r69b = 217
  integer, parameter :: r70b = 218
  integer, parameter :: r71b = 219
  integer, parameter :: r72b = 220
  integer, parameter :: r73b = 221
  integer, parameter :: r74b = 222
  integer, parameter :: r75b = 223
  integer, parameter :: r76b = 224
  integer, parameter :: r77b = 225
  integer, parameter :: r78b = 226
  integer, parameter :: r79b = 227
  integer, parameter :: r80b = 228
  integer, parameter :: r81b = 229
  integer, parameter :: r82b = 230
  integer, parameter :: r83b = 231
  integer, parameter :: r84b = 232
  integer, parameter :: r85b = 233
  integer, parameter :: r86b = 234
  integer, parameter :: r87b = 235
  integer, parameter :: r88b = 236
  integer, parameter :: r89b = 237
  integer, parameter :: r90b = 238
  integer, parameter :: r91b = 239
  integer, parameter :: r92b = 240
  integer, parameter :: r93b = 241
  integer, parameter :: r94b = 242
  integer, parameter :: r95b = 243
  integer, parameter :: r98b = 244
  integer, parameter :: r99b = 245
  integer, parameter :: r100b = 246
  integer, parameter :: r101b = 247
  integer, parameter :: r102b = 248
  integer, parameter :: r103b = 249
  integer, parameter :: r104b = 250
  integer, parameter :: r105b = 251
  integer, parameter :: r106b = 252
  integer, parameter :: r107b = 253
  integer, parameter :: r108b = 254
  integer, parameter :: r109b = 255
  integer, parameter :: r110b = 256
  integer, parameter :: r111b = 257
  integer, parameter :: r112b = 258
  integer, parameter :: r116b = 259
  integer, parameter :: r118b = 260
  integer, parameter :: r119b = 261
  integer, parameter :: r120b = 262
  integer, parameter :: r121b = 263
  integer, parameter :: r122b = 264
  integer, parameter :: r124b = 265
  integer, parameter :: r128b = 266
  integer, parameter :: r135b = 267
  integer, parameter :: r136b = 268
  integer, parameter :: r137b = 269
  integer, parameter :: r138b = 270
  integer, parameter :: r139b = 271
  integer, parameter :: r140b = 272
  integer, parameter :: r141b = 273
  integer, parameter :: r142b = 274
  integer, parameter :: r143b = 275
  integer, parameter :: r144b = 276
  integer, parameter :: r145b = 277
  integer, parameter :: r146b = 278
  integer, parameter :: r147b = 279
  integer, parameter :: r148b = 280
  integer, parameter :: r149b = 281
  integer, parameter :: r150b = 282
  integer, parameter :: r151b = 283
  
  ! Index of third body species
  integer, parameter :: mM4 = 1
  integer, parameter :: mM63 = 2
  integer, parameter :: mM82 = 3
  integer, parameter :: mM116 = 4
  integer, parameter :: mM133 = 5
  integer, parameter :: mM146 = 6
  
  integer, parameter :: mM11 = 7
  integer, parameter :: mM12 = 8
  integer, parameter :: mM15 = 9
  integer, parameter :: mM28 = 10
  integer, parameter :: mM40 = 11
  integer, parameter :: mM41 = 12
  integer, parameter :: mM57 = 13
  integer, parameter :: mM58 = 14
  integer, parameter :: mM70 = 15
  integer, parameter :: mM71 = 16
  integer, parameter :: mM72 = 17
  integer, parameter :: mM73 = 18
  integer, parameter :: mM78 = 19
  integer, parameter :: mM81 = 20
  integer, parameter :: mM89 = 21
  integer, parameter :: mM107 = 22
  integer, parameter :: mM143 = 23
  
  ! Index of third body reactions
  integer, parameter :: TBr4f = 1
  integer, parameter :: TBr63f = 2
  integer, parameter :: TBr82f = 3
  integer, parameter :: TBr116f = 4
  integer, parameter :: TBr133f = 5
  integer, parameter :: TBr146f = 6
  integer, parameter :: TBr4b = 7
  integer, parameter :: TBr63b = 8
  integer, parameter :: TBr82b = 9
  integer, parameter :: TBr116b = 10
  integer, parameter :: TBr146b = 11
  
  ! Index of fall off reactions
  integer, parameter :: FOr11f = 1
  integer, parameter :: FOr12f = 2
  integer, parameter :: FOr15f = 3
  integer, parameter :: FOr28f = 4
  integer, parameter :: FOr40f = 5
  integer, parameter :: FOr41f = 6
  integer, parameter :: FOr57f = 7
  integer, parameter :: FOr58f = 8
  integer, parameter :: FOr70f = 9
  integer, parameter :: FOr71f = 10
  integer, parameter :: FOr72f = 11
  integer, parameter :: FOr73f = 12
  integer, parameter :: FOr78f = 13
  integer, parameter :: FOr81f = 14
  integer, parameter :: FOr89f = 15
  integer, parameter :: FOr107f = 16
  integer, parameter :: FOr143f = 17
  integer, parameter :: FOr11b = 18
  integer, parameter :: FOr12b = 19
  integer, parameter :: FOr15b = 20
  integer, parameter :: FOr28b = 21
  integer, parameter :: FOr40b = 22
  integer, parameter :: FOr41b = 23
  integer, parameter :: FOr57b = 24
  integer, parameter :: FOr58b = 25
  integer, parameter :: FOr70b = 26
  integer, parameter :: FOr71b = 27
  integer, parameter :: FOr72b = 28
  integer, parameter :: FOr73b = 29
  integer, parameter :: FOr78b = 30
  integer, parameter :: FOr81b = 31
  integer, parameter :: FOr89b = 32
  integer, parameter :: FOr107b = 33
  integer, parameter :: FOr143b = 34
  
  ! Molar mass
  real(pr), parameter, dimension(nspec) :: W_sp =(/ &
       2.801348e-02_pr, & ! N2
       2.015880e-03_pr, & ! H2
       1.007940e-03_pr, & ! H
       3.199880e-02_pr, & ! O2
       1.599940e-02_pr, & ! O
       1.801528e-02_pr, & ! H2O
       1.700734e-02_pr, & ! OH
       2.801040e-02_pr, & ! CO
       4.400980e-02_pr, & ! CO2
       1.604276e-02_pr, & ! CH4
       1.503482e-02_pr, & ! CH3
       3.002628e-02_pr, & ! CH2O
       3.006964e-02_pr, & ! C2H6
       3.300674e-02_pr, & ! HO2
       2.805376e-02_pr, & ! C2H4
       3.000614e-02_pr, & ! NO
       4.401288e-02_pr, & ! N2O
       4.600554e-02_pr & ! NO2
      !2.603788e-02_pr, & ! C2H2
      !1.402688e-02_pr, & ! CH2GL1G
      !3.204216e-02_pr, & ! CH3OH
      !3.103422e-02_pr, & ! CH3O
      !3.103422e-02_pr, & ! CH2OH
      !2.901834e-02_pr, & ! HCO
      !2.906170e-02_pr, & ! C2H5
      !2.704582e-02_pr, & ! C2H3
      !4.203728e-02_pr, & ! CH2CO
      !3.101408e-02_pr, & ! HNO
      !1.400674e-02_pr, & ! N
      !2.902142e-02_pr, & ! N2H
      !1.602262e-02_pr, & ! NH2
      !1.501468e-02_pr & ! NH
       /)
  
contains

  ! ----------------------------------------------- !
  ! Subroutine for pressure dependent coefficients  !
  ! ----------------------------------------------- !
  real(pr) function getlindratecoeff(Tloc,k0,kinf,fc,concin,Ploc)
    implicit none

    real(pr) ::  Tloc,k0,kinf,fc,redP,Ploc
    real(pr) :: ntmp,ccoeff,dcoeff,lgknull
    real(pr) :: f
    real(pr) :: conc, concin

    if (concin.gt.0.0_pr) then
       conc = concin
    else
       conc = Ploc / ( Rcst * Tloc )
    end if
    
    redP = abs(k0) * conc / max(abs(kinf), tiny(1.0_pr)) + tiny(1.0_pr)

    ntmp = 0.75_pr - 1.27_pr * log10( fc )
    ccoeff = - 0.4_pr - 0.67_pr * log10( fc )
    dcoeff = 0.14_pr
    lgknull = log10(redP)
    f = (lgknull+ccoeff)/(ntmp-dcoeff*(lgknull+ccoeff))
    f = fc**(1.0_pr / ( f * f + 1.0_pr ))
    
    getlindratecoeff = kinf * f * redP / ( 1.0_pr + redP )

  end function getlindratecoeff

  ! ----------------------------------------------- !
  ! Evaluate thirdbodies                            !
  ! ----------------------------------------------- !
  subroutine get_thirdbodies(M,c)
    implicit none

    real(pr), dimension(nspec) :: c
    real(pr), dimension(nTB + nFO) :: M

    M(mM4) = (1.000000e+00_pr)*c(sCH4) &
         + (2.650000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM63) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM82) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM116) = sum(c)

    M(mM133) = sum(c)

    M(mM146) = sum(c)

    M(mM11) = (1.000000e+00_pr)*c(sCH4) &
         + (9.000000e-01_pr)*c(sCO) &
         + (2.800000e+00_pr)*c(sCO2) &
         + (9.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM12) = (7.500000e-01_pr)*c(sCO) &
         + (2.600000e+00_pr)*c(sCO2) &
         + (1.100000e+01_pr)*c(sH2O) &
         + sum(c)

    M(mM15) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM28) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM40) = sum(c)

    M(mM41) = sum(c)

    M(mM57) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM58) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM70) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM71) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM72) = (1.000000e+00_pr)*c(sCO) &
         + (2.000000e+00_pr)*c(sCO2) &
         + (4.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM73) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM78) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM81) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM89) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM107) = (1.000000e+00_pr)*c(sCH4) &
         + (5.000000e-01_pr)*c(sCO) &
         + (1.000000e+00_pr)*c(sCO2) &
         + (5.000000e+00_pr)*c(sH2O) &
         + sum(c)

    M(mM143) = (9.000000e+00_pr)*c(sH2O) &
         + (5.000000e-01_pr)*c(sO2) &
         + sum(c)

  end subroutine get_thirdbodies
  
  ! ----------------------------------------------- !
  ! Evaluate rate coefficients                      !
  ! ----------------------------------------------- !
  subroutine get_rate_coefficients(k,M,Tloc,Ploc)
    implicit none

    real(pr), dimension(nreac + nreac_reverse) :: k
    real(pr), dimension(nFO + nFO_reverse) :: k_0
    real(pr), dimension(nFO + nFO_reverse) :: k_inf
    real(pr), dimension(nFO + nFO_reverse) :: FC
    real(pr), dimension(nTB + nFO) :: M
    real(pr) :: Tloc,Ploc,R_T_inv,T_log,redP

    ! Rate coefficients
    R_T_inv = 1.0_pr/(Rcst*Tloc)
    T_log = log(Tloc)

    k(r1f) = (5.080000e-02_pr)*exp((-2.632573e+04_pr)*R_T_inv + (2.670000e+00_pr)*T_log )
    k(r2f) = (4.380000e+07_pr)*exp((-2.924616e+04_pr)*R_T_inv )
    k(r3f) = (1.140000e+08_pr)*exp((-6.395662e+04_pr)*R_T_inv )
    k(r4f) = (3.500000e+10_pr)*exp((-2.000000e+00_pr)*T_log )
    k(r5f) = (6.700000e+01_pr)*exp((-6.270477e+04_pr)*R_T_inv + (1.704000e+00_pr)*T_log )
    k(r6f) = (7.079000e+07_pr)*exp((-1.234280e+03_pr)*R_T_inv )
    k(r7f) = (1.140200e+04_pr)*exp((-2.317016e+03_pr)*R_T_inv + (1.082700e+00_pr)*T_log )
    k(r8f) = (3.250000e+07_pr)
    k(r9f) = (7.000000e+06_pr)*exp((4.572945e+03_pr)*R_T_inv )
    k(r10f) = (4.500000e+08_pr)*exp((-4.572945e+04_pr)*R_T_inv )
    k_0(FOr11f) =(1.737000e+07_pr)*exp((-1.230000e+00_pr)*T_log )
    k_inf(FOr11f) =(4.650000e+06_pr)*exp((4.400000e-01_pr)*T_log )
    FC(FOr11f) = ((1.0_pr - 6.700000e-01_pr)*exp(-Tloc/(1.000000e-30_pr)) + (6.700000e-01_pr)*exp(-Tloc/(1.000000e+30_pr)))&
              + exp(-(1.000000e+30_pr)/Tloc)
    k(r11f) = getlindratecoeff(Tloc, k_0(FOr11f), k_inf(FOr11f),FC(FOr11f), M(mM11),Ploc)
    k_0(FOr12f) =(1.173000e+12_pr)*exp((-1.753514e+04_pr)*R_T_inv + (-2.790000e+00_pr)*T_log )
    k_inf(FOr12f) =(1.362000e+04_pr)*exp((-9.974656e+03_pr)*R_T_inv )
    redP = abs(k_0(FOr12f)) * M(mM12) / max(abs(k_inf(FOr12f)), tiny(1.0_pr)) + tiny(1.0_pr)
    k(r12f) = k_inf(FOr12f) * redP / ( 1.0_pr + redP )
    k(r13f) = (7.015000e-02_pr)*exp((1.488249e+03_pr)*R_T_inv + (2.053000e+00_pr)*T_log )
    k(r14f) = (5.757000e+06_pr)*exp((-1.388251e+03_pr)*R_T_inv + (-6.640000e-01_pr)*T_log )
    k_0(FOr15f) =(2.477000e+21_pr)*exp((-1.020896e+04_pr)*R_T_inv + (-4.760000e+00_pr)*T_log )
    k_inf(FOr15f) =(1.270000e+10_pr)*exp((-1.602472e+03_pr)*R_T_inv + (-6.300000e-01_pr)*T_log )
    FC(FOr15f) = ((1.0_pr - 7.830000e-01_pr)*exp(-Tloc/(7.400000e+01_pr)) + (7.830000e-01_pr)*exp(-Tloc/(2.941000e+03_pr)))&
              + exp(-(6.964000e+03_pr)/Tloc)
    k(r15f) = getlindratecoeff(Tloc, k_0(FOr15f), k_inf(FOr15f),FC(FOr15f), M(mM15),Ploc)
    k(r16f) = (6.140000e-01_pr)*exp((-4.011201e+04_pr)*R_T_inv + (2.500000e+00_pr)*T_log )
    k(r17f) = (1.020000e+03_pr)*exp((-3.598240e+04_pr)*R_T_inv + (1.500000e+00_pr)*T_log )
    k(r18f) = (5.830000e-02_pr)*exp((-9.162960e+03_pr)*R_T_inv + (2.600000e+00_pr)*T_log )
    k(r19f) = (1.160000e-01_pr)*exp((1.264405e+04_pr)*R_T_inv + (2.230000e+00_pr)*T_log )
    k(r20f) = (1.326516e+01_pr)*exp((-3.663295e+04_pr)*R_T_inv + (1.785451e+00_pr)*T_log )
    k(r21f) = (1.746412e-01_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r22f) = (7.484624e-02_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r23f) = (9.355780e-02_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r24f) = (9.355780e-02_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r25f) = (4.366031e-01_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r26f) = (1.871156e-01_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r27f) = (8.732062e-02_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k_0(FOr28f) =(1.725550e+16_pr)*exp((-7.177589e+03_pr)*R_T_inv + (-3.354549e+00_pr)*T_log )
    k_inf(FOr28f) =(1.348086e+11_pr)*exp((-2.031268e+03_pr)*R_T_inv + (-1.014549e+00_pr)*T_log )
    FC(FOr28f) = ((1.0_pr - 6.800000e-01_pr)*exp(-Tloc/(7.800000e+01_pr)) + (6.800000e-01_pr)*exp(-Tloc/(1.995000e+03_pr)))&
              + exp(-(5.590000e+03_pr)/Tloc)
    k(r28f) = getlindratecoeff(Tloc, k_0(FOr28f), k_inf(FOr28f),FC(FOr28f), M(mM28),Ploc)
    k(r29f) = (5.715883e+07_pr)*exp((-8.307269e+03_pr)*R_T_inv + (-2.145491e-01_pr)*T_log )
    k(r30f) = (1.423578e+07_pr)*exp((-8.307269e+03_pr)*R_T_inv + (-2.145491e-01_pr)*T_log )
    k(r31f) = (2.696171e+08_pr)*exp((-2.031268e+03_pr)*R_T_inv + (-2.145491e-01_pr)*T_log )
    k(r32f) = (7.546000e+06_pr)*exp((-1.184909e+05_pr)*R_T_inv )
    k(r33f) = (2.641000e-06_pr)*exp((-3.391132e+04_pr)*R_T_inv + (3.283000e+00_pr)*T_log )
    k(r34f) = (5.540000e+07_pr)*exp((5.690240e+02_pr)*R_T_inv + (5.000000e-02_pr)*T_log )
    k(r35f) = (5.282000e+11_pr)*exp((-7.414048e+03_pr)*R_T_inv + (-1.518000e+00_pr)*T_log )
    k(r36f) = (4.686000e+04_pr)*exp((-1.492014e+04_pr)*R_T_inv + (8.330000e-01_pr)*T_log )
    k(r37f) = (1.230000e+03_pr)*exp((-4.999880e+04_pr)*R_T_inv + (1.011000e+00_pr)*T_log )
    k(r38f) = (4.293000e-02_pr)*exp((-1.672680e+04_pr)*R_T_inv + (2.568000e+00_pr)*T_log )
    k(r39f) = (1.000000e+06_pr)*exp((2.876500e+03_pr)*R_T_inv + (2.690000e-01_pr)*T_log )
    k_0(FOr40f) =(1.500000e+37_pr)*exp((-4.099994e+05_pr)*R_T_inv + (-6.995000e+00_pr)*T_log )
    k_inf(FOr40f) =(2.084000e+18_pr)*exp((-3.871899e+05_pr)*R_T_inv + (-6.150000e-01_pr)*T_log )
    FC(FOr40f) = ((1.0_pr - -4.748000e-01_pr)*exp(-Tloc/(3.558000e+04_pr)) + (-4.748000e-01_pr)*exp(-Tloc/(1.116000e+03_pr)))&
              + exp(-(9.023000e+03_pr)/Tloc)
    k(r40f) = getlindratecoeff(Tloc, k_0(FOr40f), k_inf(FOr40f),FC(FOr40f), M(mM40),Ploc)
    k_0(FOr41f) =(1.430000e+41_pr)*exp((-4.159611e+05_pr)*R_T_inv + (-8.227000e+00_pr)*T_log )
    k_inf(FOr41f) =(3.121000e+18_pr)*exp((-3.837230e+05_pr)*R_T_inv + (-1.017000e+00_pr)*T_log )
    FC(FOr41f) = ((1.0_pr - 2.545000e+00_pr)*exp(-Tloc/(3.290000e+03_pr)) + (2.545000e+00_pr)*exp(-Tloc/(4.732000e+04_pr)))&
              + exp(-(4.711000e+04_pr)/Tloc)
    k(r41f) = getlindratecoeff(Tloc, k_0(FOr41f), k_inf(FOr41f),FC(FOr41f), M(mM41),Ploc)
    k(r42f) = (1.990000e-01_pr)*exp((-4.309520e+04_pr)*R_T_inv + (2.560000e+00_pr)*T_log )
    k(r43f) = (3.070000e-01_pr)*exp((-2.276096e+04_pr)*R_T_inv + (2.550000e+00_pr)*T_log )
    k(r44f) = (3.880000e-02_pr)*exp((-1.288672e+04_pr)*R_T_inv + (2.500000e+00_pr)*T_log )
    k(r45f) = (3.880000e-01_pr)*exp((-1.288672e+04_pr)*R_T_inv + (2.500000e+00_pr)*T_log )
    k(r46f) = (1.500000e-04_pr)*exp((3.192392e+03_pr)*R_T_inv + (3.030000e+00_pr)*T_log )
    k(r47f) = (3.080000e-02_pr)*exp((3.375233e+03_pr)*R_T_inv + (2.650000e+00_pr)*T_log )
    k(r48f) = (3.220000e-03_pr)*exp((-3.589663e+04_pr)*R_T_inv + (2.425000e+00_pr)*T_log )
    k(r49f) = (1.510000e+09_pr)*exp((-1.000000e+00_pr)*T_log )
    k(r50f) = (2.410000e+08_pr)*exp((-2.099113e+04_pr)*R_T_inv )
    k(r51f) = (6.000000e+06_pr)
    k(r52f) = (2.400000e+07_pr)
    k(r53f) = (4.200000e+07_pr)
    k(r54f) = (4.380000e-25_pr)*exp((2.301618e+04_pr)*R_T_inv + (9.500000e+00_pr)*T_log )
    k(r55f) = (2.000000e+07_pr)
    k(r56f) = (1.200000e+07_pr)
    k_0(FOr57f) =(1.350000e+12_pr)*exp((-5.962200e+03_pr)*R_T_inv + (-2.570000e+00_pr)*T_log )
    k_inf(FOr57f) =(1.090000e+06_pr)*exp((1.087840e+03_pr)*R_T_inv + (4.800000e-01_pr)*T_log )
    FC(FOr57f) = ((1.0_pr - 7.824000e-01_pr)*exp(-Tloc/(2.710000e+02_pr)) + (7.824000e-01_pr)*exp(-Tloc/(2.755000e+03_pr)))&
              + exp(-(6.570000e+03_pr)/Tloc)
    k(r57f) = getlindratecoeff(Tloc, k_0(FOr57f), k_inf(FOr57f),FC(FOr57f), M(mM57),Ploc)
    k_0(FOr58f) =(5.070000e+15_pr)*exp((-3.529120e+05_pr)*R_T_inv + (-3.420000e+00_pr)*T_log )
    k_inf(FOr58f) =(4.300000e+01_pr)*exp((-3.330464e+05_pr)*R_T_inv + (1.500000e+00_pr)*T_log )
    FC(FOr58f) = ((1.0_pr - 9.320000e-01_pr)*exp(-Tloc/(1.970000e+02_pr)) + (9.320000e-01_pr)*exp(-Tloc/(1.540000e+03_pr)))&
              + exp(-(1.030000e+04_pr)/Tloc)
    k(r58f) = getlindratecoeff(Tloc, k_0(FOr58f), k_inf(FOr58f),FC(FOr58f), M(mM58),Ploc)
    k(r59f) = (6.260000e+03_pr)*exp((-9.455840e+03_pr)*R_T_inv + (1.150000e+00_pr)*T_log )
    k(r60f) = (5.740000e+01_pr)*exp((-1.146416e+04_pr)*R_T_inv + (1.900000e+00_pr)*T_log )
    k(r61f) = (7.820000e+01_pr)*exp((4.414120e+03_pr)*R_T_inv + (1.630000e+00_pr)*T_log )
    k(r62f) = (3.830000e-05_pr)*exp((-1.804141e+04_pr)*R_T_inv + (3.360000e+00_pr)*T_log )
    k(r63f) = (5.700000e+05_pr)*exp((-6.221608e+04_pr)*R_T_inv + (6.600000e-01_pr)*T_log )
    k(r64f) = (7.580000e+06_pr)*exp((-1.715440e+03_pr)*R_T_inv )
    k(r65f) = (3.020000e+07_pr)
    k(r66f) = (7.340000e+07_pr)
    k(r67f) = (3.011000e+07_pr)
    k(r68f) = (2.650000e+07_pr)
    k(r69f) = (3.000000e+07_pr)
    k_0(FOr70f) =(1.270000e+20_pr)*exp((-2.732152e+04_pr)*R_T_inv + (-4.820000e+00_pr)*T_log )
    k_inf(FOr70f) =(5.400000e+05_pr)*exp((-1.506240e+04_pr)*R_T_inv + (4.540000e-01_pr)*T_log )
    FC(FOr70f) = ((1.0_pr - 7.187000e-01_pr)*exp(-Tloc/(1.030000e+02_pr)) + (7.187000e-01_pr)*exp(-Tloc/(1.291000e+03_pr)))&
              + exp(-(4.160000e+03_pr)/Tloc)
    k(r70f) = getlindratecoeff(Tloc, k_0(FOr70f), k_inf(FOr70f),FC(FOr70f), M(mM70),Ploc)
    k_0(FOr71f) =(1.867000e+19_pr)*exp((-1.017005e+05_pr)*R_T_inv + (-3.000000e+00_pr)*T_log )
    k_inf(FOr71f) =(6.800000e+13_pr)*exp((-1.094953e+05_pr)*R_T_inv )
    FC(FOr71f) = ((1.0_pr - 9.000000e-01_pr)*exp(-Tloc/(2.500000e+03_pr)) + (9.000000e-01_pr)*exp(-Tloc/(1.300000e+03_pr)))&
              + exp(-(1.000000e+99_pr)/Tloc)
    k(r71f) = getlindratecoeff(Tloc, k_0(FOr71f), k_inf(FOr71f),FC(FOr71f), M(mM71),Ploc)
    k_0(FOr72f) =(8.054000e+19_pr)*exp((-4.107014e+03_pr)*R_T_inv + (-3.750000e+00_pr)*T_log )
    k_inf(FOr72f) =(2.277000e+09_pr)*exp((-7.317816e+02_pr)*R_T_inv + (-6.900000e-01_pr)*T_log )
    FC(FOr72f) = ((1.0_pr - 0.000000e+00_pr)*exp(-Tloc/(5.700000e+02_pr)) + (0.000000e+00_pr)*exp(-Tloc/(1.000000e+30_pr)))&
              + exp(-(1.000000e+30_pr)/Tloc)
    k(r72f) = getlindratecoeff(Tloc, k_0(FOr72f), k_inf(FOr72f),FC(FOr72f), M(mM72),Ploc)
    k_0(FOr73f) =(1.990000e+29_pr)*exp((-2.797004e+04_pr)*R_T_inv + (-7.080000e+00_pr)*T_log )
    k_inf(FOr73f) =(5.210000e+11_pr)*exp((-6.610720e+03_pr)*R_T_inv + (-9.900000e-01_pr)*T_log )
    FC(FOr73f) = ((1.0_pr - 8.420000e-01_pr)*exp(-Tloc/(1.250000e+02_pr)) + (8.420000e-01_pr)*exp(-Tloc/(2.219000e+03_pr)))&
              + exp(-(6.882000e+03_pr)/Tloc)
    k(r73f) = getlindratecoeff(Tloc, k_0(FOr73f), k_inf(FOr73f),FC(FOr73f), M(mM73),Ploc)
    k(r74f) = (3.550000e+00_pr)*exp((-2.439272e+04_pr)*R_T_inv + (2.400000e+00_pr)*T_log )
    k(r75f) = (1.150000e+02_pr)*exp((-3.150552e+04_pr)*R_T_inv + (1.900000e+00_pr)*T_log )
    k(r76f) = (1.480000e+01_pr)*exp((-3.974800e+03_pr)*R_T_inv + (1.900000e+00_pr)*T_log )
    k(r77f) = (5.550000e-10_pr)*exp((-1.351850e+04_pr)*R_T_inv + (4.720000e+00_pr)*T_log )
    k_0(FOr78f) =(1.419000e+27_pr)*exp((-2.413750e+04_pr)*R_T_inv + (-6.642000e+00_pr)*T_log )
    k_inf(FOr78f) =(9.569000e+02_pr)*exp((-5.669320e+03_pr)*R_T_inv + (1.463000e+00_pr)*T_log )
    FC(FOr78f) = ((1.0_pr - -5.690000e-01_pr)*exp(-Tloc/(2.990000e+02_pr)) + (-5.690000e-01_pr)*exp(-Tloc/(-9.147000e+03_pr)))&
              + exp(-(1.524000e+02_pr)/Tloc)
    k(r78f) = getlindratecoeff(Tloc, k_0(FOr78f), k_inf(FOr78f),FC(FOr78f), M(mM78),Ploc)
    k(r79f) = (1.180000e-02_pr)*exp((1.222146e+04_pr)*R_T_inv + (2.450000e+00_pr)*T_log )
    k(r80f) = (3.100000e+08_pr)*exp((-5.595054e+04_pr)*R_T_inv + (-3.620000e-01_pr)*T_log )
    k_0(FOr81f) =(1.400000e+18_pr)*exp((-1.389088e+04_pr)*R_T_inv + (-3.860000e+00_pr)*T_log )
    k_inf(FOr81f) =(6.080000e+06_pr)*exp((-1.171520e+03_pr)*R_T_inv + (2.700000e-01_pr)*T_log )
    FC(FOr81f) = ((1.0_pr - 7.820000e-01_pr)*exp(-Tloc/(2.075000e+02_pr)) + (7.820000e-01_pr)*exp(-Tloc/(2.663000e+03_pr)))&
              + exp(-(6.095000e+03_pr)/Tloc)
    k(r81f) = getlindratecoeff(Tloc, k_0(FOr81f), k_inf(FOr81f),FC(FOr81f), M(mM81),Ploc)
    k(r82f) = (2.610000e+10_pr)*exp((-2.837714e+05_pr)*R_T_inv )
    k(r83f) = (5.070000e+01_pr)*exp((-5.418280e+04_pr)*R_T_inv + (1.930000e+00_pr)*T_log )
    k(r84f) = (2.230000e-02_pr)*exp((-9.269652e+03_pr)*R_T_inv + (2.745000e+00_pr)*T_log )
    k(r85f) = (9.760000e-04_pr)*exp((-6.337923e+04_pr)*R_T_inv + (2.947000e+00_pr)*T_log )
    k(r86f) = (8.130000e-11_pr)*exp((-3.696899e+04_pr)*R_T_inv + (4.417000e+00_pr)*T_log )
    k(r87f) = (7.453000e+00_pr)*exp((-7.656720e+02_pr)*R_T_inv + (1.880000e+00_pr)*T_log )
    k(r88f) = (1.247437e-01_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k_0(FOr89f) =(6.346000e+19_pr)*exp((-1.581552e+04_pr)*R_T_inv + (-4.664000e+00_pr)*T_log )
    k_inf(FOr89f) =(1.710000e+04_pr)*exp((-1.133446e+04_pr)*R_T_inv + (1.266000e+00_pr)*T_log )
    FC(FOr89f) = ((1.0_pr - 7.880000e-01_pr)*exp(-Tloc/(-1.020000e+04_pr)) + (7.880000e-01_pr)*exp(-Tloc/(1.000000e-30_pr)))
    k(r89f) = getlindratecoeff(Tloc, k_0(FOr89f), k_inf(FOr89f),FC(FOr89f), M(mM89),Ploc)
    k(r90f) = (2.150000e+01_pr)*exp((-1.408753e+04_pr)*R_T_inv + (1.190000e+00_pr)*T_log )
    k(r91f) = (4.600000e-05_pr)*exp((2.061875e+03_pr)*R_T_inv + (2.760000e+00_pr)*T_log )
    k(r92f) = (1.060000e-03_pr)*exp((-2.585712e+04_pr)*R_T_inv + (2.390000e+00_pr)*T_log )
    k(r93f) = (5.260000e-07_pr)*exp((-7.434968e+03_pr)*R_T_inv + (3.010000e+00_pr)*T_log )
    k(r94f) = (2.730000e+29_pr)*exp((-4.945488e+04_pr)*R_T_inv + (-7.320000e+00_pr)*T_log )
    k(r95f) = (6.080000e+09_pr)*exp((-2.701609e+03_pr)*R_T_inv + (-1.310000e+00_pr)*T_log )
    k(r96f) = (6.360000e+29_pr)*exp((-4.945488e+04_pr)*R_T_inv + (-7.320000e+00_pr)*T_log )
    k(r97f) = (1.420000e+10_pr)*exp((-2.701609e+03_pr)*R_T_inv + (-1.310000e+00_pr)*T_log )
    k(r98f) = (1.030000e+05_pr)*exp((3.128795e+03_pr)*R_T_inv + (-3.300000e-01_pr)*T_log )
    k(r99f) = (5.770000e+15_pr)*exp((-1.996605e+04_pr)*R_T_inv + (-3.540000e+00_pr)*T_log )
    k(r100f) = (7.250000e+25_pr)*exp((-4.368096e+04_pr)*R_T_inv + (-6.700000e+00_pr)*T_log )
    k(r101f) = (5.320000e+07_pr)*exp((-1.868993e+03_pr)*R_T_inv + (-1.140000e+00_pr)*T_log )
    k(r102f) = (9.635250e+07_pr)
    k(r103f) = (3.011000e+07_pr)
    k(r104f) = (7.395000e+02_pr)*exp((-1.034285e+04_pr)*R_T_inv + (1.280000e+00_pr)*T_log )
    k(r105f) = (7.528000e+00_pr)*exp((-8.811504e+03_pr)*R_T_inv + (1.550000e+00_pr)*T_log )
    k(r106f) = (1.277000e+03_pr)*exp((-1.079054e+04_pr)*R_T_inv + (7.300000e-01_pr)*T_log )
    k_0(FOr107f) =(3.000000e+09_pr)*exp((-2.384880e+05_pr)*R_T_inv )
    k_inf(FOr107f) =(3.000000e+13_pr)*exp((-2.970640e+05_pr)*R_T_inv )
    redP = abs(k_0(FOr107f)) * M(mM107) / max(abs(k_inf(FOr107f)), tiny(1.0_pr)) + tiny(1.0_pr)
    k(r107f) = k_inf(FOr107f) * redP / ( 1.0_pr + redP )
    k(r108f) = (3.000000e+07_pr)
    k(r109f) = (7.770000e+02_pr)*exp((-1.163152e+04_pr)*R_T_inv + (1.450000e+00_pr)*T_log )
    k(r110f) = (2.000000e+06_pr)*exp((4.225840e+03_pr)*R_T_inv )
    k(r111f) = (4.160000e+18_pr)*exp((-4.083584e+04_pr)*R_T_inv + (-3.190000e+00_pr)*T_log )
    k(r112f) = (4.920000e+03_pr)*exp((-2.509438e+03_pr)*R_T_inv + (1.020000e+00_pr)*T_log )
    k(r113f) = (1.000000e+07_pr)*exp((-6.276000e+04_pr)*R_T_inv )
    k(r114f) = (2.000000e+07_pr)*exp((-9.623200e+03_pr)*R_T_inv )
    k(r115f) = (1.000000e+07_pr)
    k(r116f) = (1.000000e+04_pr)
    k(r117f) = (1.000000e+08_pr)*exp((-1.004160e+05_pr)*R_T_inv )
    k(r118f) = (2.696171e+08_pr)*exp((-2.031268e+03_pr)*R_T_inv + (-2.145491e-01_pr)*T_log )
    k(r119f) = (1.617703e+08_pr)*exp((-2.031268e+03_pr)*R_T_inv + (-2.145491e-01_pr)*T_log )
    k(r120f) = (5.931577e+05_pr)*exp((-6.215269e+03_pr)*R_T_inv + (-2.145491e-01_pr)*T_log )
    k(r121f) = (1.871156e-01_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r122f) = (2.681990e-01_pr)*exp((1.763074e+04_pr)*R_T_inv + (1.988656e+00_pr)*T_log )
    k(r123f) = (5.000000e+08_pr)*exp((-1.338880e+05_pr)*R_T_inv )
    k(r124f) = (3.000000e+13_pr)*exp((-3.284440e+05_pr)*R_T_inv )
    k(r125f) = (2.000000e+07_pr)*exp((-2.092000e+04_pr)*R_T_inv )
    k(r126f) = (1.000000e+05_pr)
    k(r127f) = (5.000000e+06_pr)*exp((-6.276000e+04_pr)*R_T_inv )
    k(r128f) = (5.000000e+05_pr)*exp((-2.719600e+04_pr)*R_T_inv )
    k(r129f) = (3.000000e+05_pr)*exp((-1.087840e+05_pr)*R_T_inv )
    k(r130f) = (1.000000e+08_pr)*exp((-2.008320e+05_pr)*R_T_inv )
    k(r131f) = (3.000000e+05_pr)*exp((-1.129680e+05_pr)*R_T_inv )
    k(r132f) = (1.000000e+08_pr)*exp((-1.799120e+05_pr)*R_T_inv )
    k(r133f) = (5.000000e+04_pr)
    k(r134f) = (1.500000e+07_pr)
    k(r135f) = (1.083000e+01_pr)*exp((-3.674372e+04_pr)*R_T_inv + (2.000000e+00_pr)*T_log )
    k(r136f) = (2.800000e+14_pr)*exp((-5.263472e+03_pr)*R_T_inv + (-2.654000e+00_pr)*T_log )
    k(r137f) = (3.100000e+07_pr)*exp((-4.937120e+03_pr)*R_T_inv + (-4.800000e-01_pr)*T_log )
    k(r138f) = (9.200000e+07_pr)
    k(r139f) = (1.800000e+08_pr)*exp((1.020896e+03_pr)*R_T_inv + (-3.510000e-01_pr)*T_log )
    k(r140f) = (2.200000e+07_pr)*exp((-2.300000e-01_pr)*T_log )
    k(r141f) = (1.470000e+07_pr)*exp((-3.150000e+05_pr)*R_T_inv + (3.000000e-01_pr)*T_log )
    k(r142f) = (2.100000e+06_pr)*exp((2.009994e+03_pr)*R_T_inv )
    k_0(FOr143f) =(2.300000e+02_pr)*exp((6.505994e+03_pr)*R_T_inv + (2.060000e-01_pr)*T_log )
    k_inf(FOr143f) =(1.500000e+09_pr)*exp((-4.000000e-01_pr)*T_log )
    redP = abs(k_0(FOr143f)) * M(mM143) / max(abs(k_inf(FOr143f)), tiny(1.0_pr)) + tiny(1.0_pr)
    k(r143f) = k_inf(FOr143f) * redP / ( 1.0_pr + redP )
    k(r144f) = (3.500000e+08_pr)*exp((-6.280017e+03_pr)*R_T_inv )
    k(r145f) = (1.000000e+07_pr)*exp((-2.509982e+03_pr)*R_T_inv )
    k(r146f) = (1.100000e+10_pr)*exp((-2.760000e+05_pr)*R_T_inv )
    k(r147f) = (3.600000e+07_pr)
    k(r148f) = (4.400000e+05_pr)*exp((-2.720018e+03_pr)*R_T_inv + (7.200000e-01_pr)*T_log )
    k(r149f) = (6.400000e+03_pr)*exp((-2.630000e+04_pr)*R_T_inv + (1.000000e+00_pr)*T_log )
    k(r150f) = (3.800000e+07_pr)
    k(r151f) = (9.150000e+07_pr)*exp((-1.158675e+05_pr)*R_T_inv )
    k(r1b) = (2.536907e-02_pr)*exp((-2.030601e+04_pr)*R_T_inv + (2.656775e+00_pr)*T_log )
    k(r2b) = (1.592922e+08_pr)*exp((-9.088480e+04_pr)*R_T_inv + (3.374885e-02_pr)*T_log )
    k(r3b) = (5.059234e+05_pr)*exp((5.835146e+03_pr)*R_T_inv + (3.353172e-01_pr)*T_log )
    k(r4b) = (2.233572e+16_pr)*exp((-4.943801e+05_pr)*R_T_inv + (-1.581830e+00_pr)*T_log )
    k(r5b) = (9.200159e+00_pr)*exp((4.953583e+03_pr)*R_T_inv + (1.657026e+00_pr)*T_log )
    k(r6b) = (6.350915e+04_pr)*exp((-1.545260e+05_pr)*R_T_inv + (5.701365e-01_pr)*T_log )
    k(r7b) = (4.615562e+03_pr)*exp((-2.314202e+05_pr)*R_T_inv + (1.330744e+00_pr)*T_log )
    k(r8b) = (6.570037e+06_pr)*exp((-2.230835e+05_pr)*R_T_inv + (2.348193e-01_pr)*T_log )
    k(r9b) = (1.030533e+07_pr)*exp((-2.861689e+05_pr)*R_T_inv + (2.817931e-01_pr)*T_log )
    k(r10b) = (6.624856e+08_pr)*exp((-3.364713e+05_pr)*R_T_inv + (2.817931e-01_pr)*T_log )
    k_0(FOr11b) =(7.529529e+12_pr)*exp((-2.036382e+05_pr)*R_T_inv + (-1.093623e+00_pr)*T_log )
    k_inf(FOr11b) =(2.015677e+12_pr)*exp((-2.036382e+05_pr)*R_T_inv + (5.763768e-01_pr)*T_log )
    FC(FOr11b) = ((1.0_pr - 6.700000e-01_pr)*exp(-Tloc/(1.000000e-30_pr)) + (6.700000e-01_pr)*exp(-Tloc/(1.000000e+30_pr)))&
              + exp(-(1.000000e+30_pr)/Tloc)
    k(r11b) = getlindratecoeff(Tloc, k_0(FOr11b), k_inf(FOr11b),FC(FOr11b), M(mM11),Ploc)
    k_0(FOr12b) =(1.295503e+23_pr)*exp((-5.502659e+05_pr)*R_T_inv + (-3.511699e+00_pr)*T_log )
    k_inf(FOr12b) =(1.504241e+15_pr)*exp((-5.427054e+05_pr)*R_T_inv + (-7.216986e-01_pr)*T_log )
    redP = abs(k_0(FOr12b)) * M(mM12) / max(abs(k_inf(FOr12b)), tiny(1.0_pr)) + tiny(1.0_pr)
    k(r12b) = k_inf(FOr12b) * redP / ( 1.0_pr + redP )
    k(r13b) = (8.841290e+04_pr)*exp((-1.045208e+05_pr)*R_T_inv + (9.601053e-01_pr)*T_log )
    k(r14b) = (7.255782e+12_pr)*exp((-1.073973e+05_pr)*R_T_inv + (-1.756895e+00_pr)*T_log )
    k_0(FOr15b) =(2.705095e+28_pr)*exp((-4.482908e+05_pr)*R_T_inv + (-4.474518e+00_pr)*T_log )
    k_inf(FOr15b) =(1.386948e+17_pr)*exp((-4.396843e+05_pr)*R_T_inv + (-3.445182e-01_pr)*T_log )
    FC(FOr15b) = ((1.0_pr - 7.830000e-01_pr)*exp(-Tloc/(7.400000e+01_pr)) + (7.830000e-01_pr)*exp(-Tloc/(2.941000e+03_pr)))&
              + exp(-(6.964000e+03_pr)/Tloc)
    k(r15b) = getlindratecoeff(Tloc, k_0(FOr15b), k_inf(FOr15b),FC(FOr15b), M(mM15),Ploc)
    k(r16b) = (9.865598e-03_pr)*exp((-3.477164e+04_pr)*R_T_inv + (2.598939e+00_pr)*T_log )
    k(r17b) = (8.184576e+00_pr)*exp((-2.462232e+04_pr)*R_T_inv + (1.585714e+00_pr)*T_log )
    k(r18b) = (3.406779e-03_pr)*exp((-6.546123e+04_pr)*R_T_inv + (2.732688e+00_pr)*T_log )
    k(r19b) = (2.922449e+00_pr)*exp((-2.217995e+05_pr)*R_T_inv + (2.379105e+00_pr)*T_log )
    k(r20b) = (3.381916e+01_pr)*exp((-7.719062e+04_pr)*R_T_inv + (1.530197e+00_pr)*T_log )
    k(r22b) = (2.049909e-02_pr)*exp((-7.420737e+05_pr)*R_T_inv + (2.461825e+00_pr)*T_log )
    k(r23b) = (1.587611e+00_pr)*exp((-7.502269e+05_pr)*R_T_inv + (2.092760e+00_pr)*T_log )
    k(r24b) = (1.493451e+01_pr)*exp((-3.814651e+05_pr)*R_T_inv + (1.612921e+00_pr)*T_log )
    k(r25b) = (6.927590e+01_pr)*exp((-2.826729e+04_pr)*R_T_inv + (1.634463e+00_pr)*T_log )
    k(r26b) = (2.195629e+03_pr)*exp((-3.222934e+05_pr)*R_T_inv + (1.532565e+00_pr)*T_log )
    k(r27b) = (8.129761e-04_pr)*exp((-2.162844e+05_pr)*R_T_inv + (2.625459e+00_pr)*T_log )
    k_0(FOr28b) =(4.804347e+23_pr)*exp((-4.858171e+05_pr)*R_T_inv + (-3.324321e+00_pr)*T_log )
    k_inf(FOr28b) =(3.753396e+18_pr)*exp((-4.806707e+05_pr)*R_T_inv + (-9.843213e-01_pr)*T_log )
    FC(FOr28b) = ((1.0_pr - 6.800000e-01_pr)*exp(-Tloc/(7.800000e+01_pr)) + (6.800000e-01_pr)*exp(-Tloc/(1.995000e+03_pr)))&
              + exp(-(5.590000e+03_pr)/Tloc)
    k(r28b) = getlindratecoeff(Tloc, k_0(FOr28b), k_inf(FOr28b),FC(FOr28b), M(mM28),Ploc)
    k(r29b) = (4.049247e+07_pr)*exp((-3.376114e+05_pr)*R_T_inv + (-2.549665e-01_pr)*T_log )
    k(r32b) = (4.467439e+09_pr)*exp((1.907730e+03_pr)*R_T_inv + (-8.240853e-01_pr)*T_log )
    k(r33b) = (4.328554e-07_pr)*exp((-2.521260e+05_pr)*R_T_inv + (3.503194e+00_pr)*T_log )
    k(r34b) = (2.045994e+09_pr)*exp((-2.874374e+05_pr)*R_T_inv + (-6.512300e-02_pr)*T_log )
    k(r35b) = (1.210663e+10_pr)*exp((-2.315465e+04_pr)*R_T_inv + (-1.130058e+00_pr)*T_log )
    k(r36b) = (1.603048e+08_pr)*exp((-8.400479e+02_pr)*R_T_inv + (-9.132895e-03_pr)*T_log )
    k(r37b) = (1.640843e+08_pr)*exp((6.080400e+02_pr)*R_T_inv + (-1.484024e-01_pr)*T_log )
    k(r38b) = (9.839792e-04_pr)*exp((-3.246740e+04_pr)*R_T_inv + (2.955942e+00_pr)*T_log )
    k(r39b) = (1.196813e+08_pr)*exp((-9.980839e+04_pr)*R_T_inv + (-3.202659e-01_pr)*T_log )
    k_0(FOr40b) =(4.857833e+27_pr)*exp((-2.434159e+04_pr)*R_T_inv + (-6.730355e+00_pr)*T_log )
    k_inf(FOr40b) =(6.749149e+08_pr)*exp((-1.532094e+03_pr)*R_T_inv + (-3.503550e-01_pr)*T_log )
    FC(FOr40b) = ((1.0_pr - -4.748000e-01_pr)*exp(-Tloc/(3.558000e+04_pr)) + (-4.748000e-01_pr)*exp(-Tloc/(1.116000e+03_pr)))&
              + exp(-(9.023000e+03_pr)/Tloc)
    k(r40b) = getlindratecoeff(Tloc, k_0(FOr40b), k_inf(FOr40b),FC(FOr40b), M(mM40),Ploc)
    k_0(FOr41b) =(1.061481e+30_pr)*exp((-4.604397e+04_pr)*R_T_inv + (-7.574413e+00_pr)*T_log )
    k_inf(FOr41b) =(2.316702e+07_pr)*exp((-1.380583e+04_pr)*R_T_inv + (-3.644129e-01_pr)*T_log )
    FC(FOr41b) = ((1.0_pr - 2.545000e+00_pr)*exp(-Tloc/(3.290000e+03_pr)) + (2.545000e+00_pr)*exp(-Tloc/(4.732000e+04_pr)))&
              + exp(-(4.711000e+04_pr)/Tloc)
    k(r41b) = getlindratecoeff(Tloc, k_0(FOr41b), k_inf(FOr41b),FC(FOr41b), M(mM41),Ploc)
    k(r42b) = (1.508613e+00_pr)*exp((-3.957203e+04_pr)*R_T_inv + (2.049664e+00_pr)*T_log )
    k(r43b) = (5.968233e-02_pr)*exp((-5.576453e+04_pr)*R_T_inv + (2.356933e+00_pr)*T_log )
    k(r44b) = (1.468917e-01_pr)*exp((-3.343834e+03_pr)*R_T_inv + (1.976439e+00_pr)*T_log )
    k(r45b) = (3.766865e-02_pr)*exp((-3.987058e+04_pr)*R_T_inv + (2.293708e+00_pr)*T_log )
    k(r46b) = (4.135580e-03_pr)*exp((-5.492308e+04_pr)*R_T_inv + (2.553412e+00_pr)*T_log )
    k(r47b) = (2.177602e-02_pr)*exp((-9.126698e+04_pr)*R_T_inv + (2.490682e+00_pr)*T_log )
    k(r48b) = (1.519237e+00_pr)*exp((-3.771382e+04_pr)*R_T_inv + (1.815724e+00_pr)*T_log )
    k(r49b) = (8.063850e+07_pr)*exp((-7.900303e+04_pr)*R_T_inv + (-5.078093e-01_pr)*T_log )
    k(r50b) = (1.287012e+07_pr)*exp((-9.999415e+04_pr)*R_T_inv + (4.921907e-01_pr)*T_log )
    k(r51b) = (1.297061e+05_pr)*exp((-3.081062e+05_pr)*R_T_inv + (7.402349e-01_pr)*T_log )
    k(r52b) = (1.886864e+06_pr)*exp((-3.697449e+05_pr)*R_T_inv + (7.739837e-01_pr)*T_log )
    k(r53b) = (4.534185e+05_pr)*exp((-3.020865e+05_pr)*R_T_inv + (7.270100e-01_pr)*T_log )
    k(r54b) = (5.998218e-28_pr)*exp((-9.251359e+04_pr)*R_T_inv + (1.030946e+01_pr)*T_log )
    k(r55b) = (1.108720e+04_pr)*exp((-3.446330e+05_pr)*R_T_inv + (1.057504e+00_pr)*T_log )
    k(r56b) = (4.140167e+05_pr)*exp((-3.499734e+05_pr)*R_T_inv + (9.585651e-01_pr)*T_log )
    k_0(FOr57b) =(8.696092e+18_pr)*exp((-3.735122e+05_pr)*R_T_inv + (-2.279161e+00_pr)*T_log )
    k_inf(FOr57b) =(7.021289e+12_pr)*exp((-3.664622e+05_pr)*R_T_inv + (7.708393e-01_pr)*T_log )
    FC(FOr57b) = ((1.0_pr - 7.824000e-01_pr)*exp(-Tloc/(2.710000e+02_pr)) + (7.824000e-01_pr)*exp(-Tloc/(2.755000e+03_pr)))&
              + exp(-(6.570000e+03_pr)/Tloc)
    k(r57b) = getlindratecoeff(Tloc, k_0(FOr57b), k_inf(FOr57b),FC(FOr57b), M(mM57),Ploc)
    k_0(FOr58b) =(3.072168e+23_pr)*exp((-3.517003e+05_pr)*R_T_inv + (-3.608999e+00_pr)*T_log )
    k_inf(FOr58b) =(2.605587e+09_pr)*exp((-3.318347e+05_pr)*R_T_inv + (1.311001e+00_pr)*T_log )
    FC(FOr58b) = ((1.0_pr - 9.320000e-01_pr)*exp(-Tloc/(1.970000e+02_pr)) + (9.320000e-01_pr)*exp(-Tloc/(1.540000e+03_pr)))&
              + exp(-(1.030000e+04_pr)/Tloc)
    k(r58b) = getlindratecoeff(Tloc, k_0(FOr58b), k_inf(FOr58b),FC(FOr58b), M(mM58),Ploc)
    k(r59b) = (8.516015e+01_pr)*exp((-6.862754e+04_pr)*R_T_inv + (1.230357e+00_pr)*T_log )
    k(r60b) = (1.563627e+00_pr)*exp((-7.665558e+04_pr)*R_T_inv + (1.993582e+00_pr)*T_log )
    k(r61b) = (7.747263e+00_pr)*exp((-1.224159e+05_pr)*R_T_inv + (1.757331e+00_pr)*T_log )
    k(r62b) = (6.493291e-05_pr)*exp((-8.857319e+04_pr)*R_T_inv + (3.354642e+00_pr)*T_log )
    k(r63b) = (3.453160e-01_pr)*exp((1.763634e+03_pr)*R_T_inv + (7.554170e-01_pr)*T_log )
    k(r64b) = (1.990577e+06_pr)*exp((-1.413740e+05_pr)*R_T_inv + (2.317938e-01_pr)*T_log )
    k(r65b) = (1.603250e+06_pr)*exp((-3.627420e+05_pr)*R_T_inv + (4.666131e-01_pr)*T_log )
    k(r66b) = (7.802780e+06_pr)*exp((-3.687617e+05_pr)*R_T_inv + (4.798380e-01_pr)*T_log )
    k(r67b) = (1.164084e+07_pr)*exp((-4.304004e+05_pr)*R_T_inv + (5.135869e-01_pr)*T_log )
    k(r68b) = (1.753251e+08_pr)*exp((-3.741021e+05_pr)*R_T_inv + (3.808988e-01_pr)*T_log )
    k(r69b) = (2.007259e+12_pr)*exp((-4.687510e+05_pr)*R_T_inv + (-6.262816e-01_pr)*T_log )
    k_0(FOr70b) =(1.030875e+27_pr)*exp((-1.519567e+05_pr)*R_T_inv + (-5.175814e+00_pr)*T_log )
    k_inf(FOr70b) =(4.383250e+12_pr)*exp((-1.396976e+05_pr)*R_T_inv + (9.818610e-02_pr)*T_log )
    FC(FOr70b) = ((1.0_pr - 7.187000e-01_pr)*exp(-Tloc/(1.030000e+02_pr)) + (7.187000e-01_pr)*exp(-Tloc/(1.291000e+03_pr)))&
              + exp(-(4.160000e+03_pr)/Tloc)
    k(r70b) = getlindratecoeff(Tloc, k_0(FOr70b), k_inf(FOr70b),FC(FOr70b), M(mM70),Ploc)
    k_0(FOr71b) =(5.898268e+10_pr)*exp((-1.359203e+04_pr)*R_T_inv + (-2.326917e+00_pr)*T_log )
    k_inf(FOr71b) =(2.148271e+05_pr)*exp((-2.138682e+04_pr)*R_T_inv + (6.730833e-01_pr)*T_log )
    FC(FOr71b) = ((1.0_pr - 9.000000e-01_pr)*exp(-Tloc/(2.500000e+03_pr)) + (9.000000e-01_pr)*exp(-Tloc/(1.300000e+03_pr)))&
              + exp(-(1.000000e+99_pr)/Tloc)
    k(r71b) = getlindratecoeff(Tloc, k_0(FOr71b), k_inf(FOr71b),FC(FOr71b), M(mM71),Ploc)
    k_0(FOr72b) =(1.245762e+32_pr)*exp((-3.836385e+05_pr)*R_T_inv + (-4.535345e+00_pr)*T_log )
    k_inf(FOr72b) =(3.521976e+21_pr)*exp((-3.802633e+05_pr)*R_T_inv + (-1.475345e+00_pr)*T_log )
    FC(FOr72b) = ((1.0_pr - 0.000000e+00_pr)*exp(-Tloc/(5.700000e+02_pr)) + (0.000000e+00_pr)*exp(-Tloc/(1.000000e+30_pr)))&
              + exp(-(1.000000e+30_pr)/Tloc)
    k(r72b) = getlindratecoeff(Tloc, k_0(FOr72b), k_inf(FOr72b),FC(FOr72b), M(mM72),Ploc)
    k_0(FOr73b) =(1.204386e+37_pr)*exp((-4.481197e+05_pr)*R_T_inv + (-6.972586e+00_pr)*T_log )
    k_inf(FOr73b) =(3.153192e+19_pr)*exp((-4.267604e+05_pr)*R_T_inv + (-8.825860e-01_pr)*T_log )
    FC(FOr73b) = ((1.0_pr - 8.420000e-01_pr)*exp(-Tloc/(1.250000e+02_pr)) + (8.420000e-01_pr)*exp(-Tloc/(2.219000e+03_pr)))&
              + exp(-(6.882000e+03_pr)/Tloc)
    k(r73b) = getlindratecoeff(Tloc, k_0(FOr73b), k_inf(FOr73b),FC(FOr73b), M(mM73),Ploc)
    k(r74b) = (5.140058e-03_pr)*exp((-3.096478e+04_pr)*R_T_inv + (2.663782e+00_pr)*T_log )
    k(r75b) = (3.334238e-01_pr)*exp((-4.409729e+04_pr)*R_T_inv + (2.177007e+00_pr)*T_log )
    k(r76b) = (1.560562e-01_pr)*exp((-7.820521e+04_pr)*R_T_inv + (2.210756e+00_pr)*T_log )
    k(r77b) = (1.001467e-10_pr)*exp((-3.145064e+04_pr)*R_T_inv + (4.898068e+00_pr)*T_log )
    k_0(FOr78b) =(1.260935e+33_pr)*exp((-1.730400e+05_pr)*R_T_inv + (-6.612945e+00_pr)*T_log )
    k_inf(FOr78b) =(8.503091e+08_pr)*exp((-1.545718e+05_pr)*R_T_inv + (1.492055e+00_pr)*T_log )
    FC(FOr78b) = ((1.0_pr - -5.690000e-01_pr)*exp(-Tloc/(2.990000e+02_pr)) + (-5.690000e-01_pr)*exp(-Tloc/(-9.147000e+03_pr)))&
              + exp(-(1.524000e+02_pr)/Tloc)
    k(r78b) = getlindratecoeff(Tloc, k_0(FOr78b), k_inf(FOr78b),FC(FOr78b), M(mM78),Ploc)
    k(r79b) = (1.450201e-01_pr)*exp((-2.769578e+05_pr)*R_T_inv + (2.706427e+00_pr)*T_log )
    k(r80b) = (7.922684e+12_pr)*exp((-1.533234e+04_pr)*R_T_inv + (-1.254759e+00_pr)*T_log )
    k_0(FOr81b) =(1.315930e+26_pr)*exp((-4.748460e+05_pr)*R_T_inv + (-3.799295e+00_pr)*T_log )
    k_inf(FOr81b) =(5.714897e+14_pr)*exp((-4.621266e+05_pr)*R_T_inv + (3.307049e-01_pr)*T_log )
    FC(FOr81b) = ((1.0_pr - 7.820000e-01_pr)*exp(-Tloc/(2.075000e+02_pr)) + (7.820000e-01_pr)*exp(-Tloc/(2.663000e+03_pr)))&
              + exp(-(6.095000e+03_pr)/Tloc)
    k(r81b) = getlindratecoeff(Tloc, k_0(FOr81b), k_inf(FOr81b),FC(FOr81b), M(mM81),Ploc)
    k(r82b) = (6.875677e+03_pr)*exp((-1.086089e+05_pr)*R_T_inv + (-3.006757e-01_pr)*T_log )
    k(r83b) = (9.464868e-02_pr)*exp((-2.596913e+04_pr)*R_T_inv + (2.253716e+00_pr)*T_log )
    k(r84b) = (1.514021e-04_pr)*exp((-4.269462e+04_pr)*R_T_inv + (3.102465e+00_pr)*T_log )
    k(r85b) = (1.133970e-04_pr)*exp((-4.050593e+04_pr)*R_T_inv + (3.171777e+00_pr)*T_log )
    k(r86b) = (9.445874e-12_pr)*exp((-1.409569e+04_pr)*R_T_inv + (4.641777e+00_pr)*T_log )
    k(r87b) = (1.485713e-03_pr)*exp((-1.107428e+05_pr)*R_T_inv + (2.395851e+00_pr)*T_log )
    k(r88b) = (9.989088e+04_pr)*exp((-2.714880e+05_pr)*R_T_inv + (1.097070e+00_pr)*T_log )
    k_0(FOr89b) =(4.497092e+23_pr)*exp((-1.627644e+05_pr)*R_T_inv + (-4.039608e+00_pr)*T_log )
    k_inf(FOr89b) =(1.211791e+08_pr)*exp((-1.582833e+05_pr)*R_T_inv + (1.890392e+00_pr)*T_log )
    FC(FOr89b) = ((1.0_pr - 7.880000e-01_pr)*exp(-Tloc/(-1.020000e+04_pr)) + (7.880000e-01_pr)*exp(-Tloc/(1.000000e-30_pr)))
    k(r89b) = getlindratecoeff(Tloc, k_0(FOr89b), k_inf(FOr89b),FC(FOr89b), M(mM89),Ploc)
    k(r90b) = (1.315148e+03_pr)*exp((-7.077691e+04_pr)*R_T_inv + (7.019850e-01_pr)*T_log )
    k(r91b) = (2.813806e-03_pr)*exp((-5.462751e+04_pr)*R_T_inv + (2.271985e+00_pr)*T_log )
    k(r92b) = (3.418340e-02_pr)*exp((-3.340867e+05_pr)*R_T_inv + (1.891017e+00_pr)*T_log )
    k(r93b) = (1.696271e-05_pr)*exp((-3.156645e+05_pr)*R_T_inv + (2.511017e+00_pr)*T_log )
    k(r94b) = (9.567387e+27_pr)*exp((-4.118800e+05_pr)*R_T_inv + (-6.894446e+00_pr)*T_log )
    k(r95b) = (2.130759e+08_pr)*exp((-3.651268e+05_pr)*R_T_inv + (-8.844457e-01_pr)*T_log )
    k(r98b) = (6.921967e+05_pr)*exp((-3.834251e+05_pr)*R_T_inv + (-4.821120e-01_pr)*T_log )
    k(r99b) = (3.877646e+16_pr)*exp((-4.065200e+05_pr)*R_T_inv + (-3.692112e+00_pr)*T_log )
    k(r100b) = (4.603163e+27_pr)*exp((-5.868507e+05_pr)*R_T_inv + (-6.785604e+00_pr)*T_log )
    k(r101b) = (3.377769e+09_pr)*exp((-5.450388e+05_pr)*R_T_inv + (-1.225604e+00_pr)*T_log )
    k(r102b) = (2.385849e+09_pr)*exp((-2.857926e+05_pr)*R_T_inv + (-2.399708e-01_pr)*T_log )
    k(r103b) = (2.711508e+09_pr)*exp((-3.474312e+05_pr)*R_T_inv + (-2.062220e-01_pr)*T_log )
    k(r104b) = (2.136552e-03_pr)*exp((-1.856047e+05_pr)*R_T_inv + (2.546137e+00_pr)*T_log )
    k(r105b) = (4.423727e+03_pr)*exp((-1.070599e+05_pr)*R_T_inv + (9.688953e-01_pr)*T_log )
    k(r106b) = (1.172251e+00_pr)*exp((-2.379702e+05_pr)*R_T_inv + (1.655169e+00_pr)*T_log )
    k_0(FOr107b) =(1.683199e-04_pr)*exp((1.112203e+05_pr)*R_T_inv + (1.476046e+00_pr)*T_log )
    k_inf(FOr107b) =(1.683199e+00_pr)*exp((5.264429e+04_pr)*R_T_inv + (1.476046e+00_pr)*T_log )
    redP = abs(k_0(FOr107b)) * M(mM107) / max(abs(k_inf(FOr107b)), tiny(1.0_pr)) + tiny(1.0_pr)
    k(r107b) = k_inf(FOr107b) * redP / ( 1.0_pr + redP )
    k(r108b) = (2.179971e+11_pr)*exp((-3.780213e+05_pr)*R_T_inv + (-8.343004e-01_pr)*T_log )
    k(r109b) = (1.213786e-03_pr)*exp((-1.405627e+05_pr)*R_T_inv + (2.956274e+00_pr)*T_log )
    k(r110b) = (1.068798e+04_pr)*exp((-1.106253e+05_pr)*R_T_inv + (6.641406e-01_pr)*T_log )
    k(r111b) = (1.232240e+18_pr)*exp((-5.852021e+04_pr)*R_T_inv + (-3.220477e+00_pr)*T_log )
    k(r112b) = (1.457361e+03_pr)*exp((-2.019380e+04_pr)*R_T_inv + (9.895228e-01_pr)*T_log )
    k(r116b) = (9.767603e+11_pr)*exp((-2.734300e+05_pr)*R_T_inv + (-1.989404e-01_pr)*T_log )
    k(r118b) = (4.575219e+09_pr)*exp((-7.698889e+05_pr)*R_T_inv + (-1.104457e-01_pr)*T_log )
    k(r119b) = (1.898225e+12_pr)*exp((-3.419555e+05_pr)*R_T_inv + (-6.706405e-01_pr)*T_log )
    k(r120b) = (5.522442e+03_pr)*exp((-2.401304e+05_pr)*R_T_inv + (4.222542e-01_pr)*T_log )
    k(r121b) = (1.809518e-05_pr)*exp((-3.174854e+05_pr)*R_T_inv + (1.708338e+00_pr)*T_log )
    k(r122b) = (6.837661e-01_pr)*exp((-2.292692e+04_pr)*R_T_inv + (1.733402e+00_pr)*T_log )
    k(r124b) = (9.788358e+04_pr)*exp((-1.921333e+05_pr)*R_T_inv + (2.479523e-01_pr)*T_log )
    k(r128b) = (4.723849e+06_pr)*exp((-1.838119e+05_pr)*R_T_inv + (6.650776e-02_pr)*T_log )
    k(r135b) = (1.009662e-02_pr)*exp((-2.510337e+03_pr)*R_T_inv + (2.310491e+00_pr)*T_log )
    k(r136b) = (6.754670e+14_pr)*exp((-5.264968e+05_pr)*R_T_inv + (-2.342818e+00_pr)*T_log )
    k(r137b) = (8.430356e+07_pr)*exp((1.020371e+03_pr)*R_T_inv + (-6.753410e-01_pr)*T_log )
    k(r138b) = (3.119306e+09_pr)*exp((-2.977215e+05_pr)*R_T_inv + (-2.100360e-01_pr)*T_log )
    k(r139b) = (3.673989e+14_pr)*exp((-1.512269e+05_pr)*R_T_inv + (-1.447816e+00_pr)*T_log )
    k(r140b) = (5.062807e+07_pr)*exp((-4.104185e+05_pr)*R_T_inv + (-6.496859e-02_pr)*T_log )
    k(r141b) = (7.933756e+06_pr)*exp((-6.615277e+02_pr)*R_T_inv + (1.968704e-01_pr)*T_log )
    k(r142b) = (9.401776e+07_pr)*exp((-3.068419e+04_pr)*R_T_inv + (-2.855353e-01_pr)*T_log )
    k_0(FOr143b) =(8.402535e+08_pr)*exp((-1.991638e+05_pr)*R_T_inv + (2.908658e-01_pr)*T_log )
    k_inf(FOr143b) =(5.479913e+15_pr)*exp((-2.056698e+05_pr)*R_T_inv + (-3.151342e-01_pr)*T_log )
    redP = abs(k_0(FOr143b)) * M(mM143) / max(abs(k_inf(FOr143b)), tiny(1.0_pr)) + tiny(1.0_pr)
    k(r143b) = k_inf(FOr143b) * redP / ( 1.0_pr + redP )
    k(r144b) = (7.013613e+03_pr)*exp((-1.268776e+05_pr)*R_T_inv + (8.556718e-01_pr)*T_log )
    k(r145b) = (4.515375e+04_pr)*exp((-1.928993e+05_pr)*R_T_inv + (5.203546e-01_pr)*T_log )
    k(r146b) = (2.515441e+00_pr)*exp((3.012419e+04_pr)*R_T_inv + (4.844757e-01_pr)*T_log )
    k(r147b) = (6.288571e+06_pr)*exp((-2.887103e+05_pr)*R_T_inv + (3.333041e-01_pr)*T_log )
    k(r148b) = (2.113400e+04_pr)*exp((-2.297917e+05_pr)*R_T_inv + (1.019555e+00_pr)*T_log )
    k(r149b) = (7.753536e+02_pr)*exp((-1.581497e+05_pr)*R_T_inv + (1.063379e+00_pr)*T_log )
    k(r150b) = (1.037346e+09_pr)*exp((-2.016415e+05_pr)*R_T_inv + (-2.719378e-01_pr)*T_log )
    k(r151b) = (1.519938e+03_pr)*exp((-2.613412e+05_pr)*R_T_inv + (8.867801e-01_pr)*T_log )
  
    return
  end subroutine get_rate_coefficients

  ! ----------------------------------------------- !
  ! Evaluate reaction rates                         !
  ! ----------------------------------------------- !
  subroutine get_reaction_rates(w,k,m,c,cqss)
    implicit none

    real(pr), dimension(nspec) :: c
    real(pr), dimension(nqss) :: cqss
    real(pr), dimension(nreac + nreac_reverse) :: w,k
    real(pr), dimension(nTB + nFO) :: m

    w(r1f) = k(r1f) * c(sH2) * c(sO) 
    w(r2f) = k(r2f) * c(sH2) * c(sOH) 
    w(r3f) = k(r3f) * c(sH) * c(sO2) 
    w(r4f) = k(r4f) * c(sH) * c(sOH) * m(mM4)
    w(r5f) = k(r5f) * c(sH2O) * c(sO) 
    w(r6f) = k(r6f) * c(sH) * c(sHO2) 
    w(r7f) = k(r7f) * c(sH) * c(sHO2) 
    w(r8f) = k(r8f) * c(sHO2) * c(sO) 
    w(r9f) = k(r9f) * c(sHO2) * c(sOH) 
    w(r10f) = k(r10f) * c(sHO2) * c(sOH) 
    w(r11f) = k(r11f) * c(sH) * c(sO2) 
    w(r12f) = k(r12f) * c(sCO) * c(sO) 
    w(r13f) = k(r13f) * c(sCO) * c(sOH) 
    w(r14f) = k(r14f) * c(sCO) * c(sOH) 
    w(r15f) = k(r15f) * c(sCH3) * c(sH) 
    w(r16f) = k(r16f) * c(sCH4) * c(sH) 
    w(r17f) = k(r17f) * c(sCH4) * c(sO) 
    w(r18f) = k(r18f) * c(sCH4) * c(sOH) 
    w(r19f) = k(r19f) * c(sCH3) * c(sHO2) 
    w(r20f) = k(r20f) * cqss(sqssCH2GL1G) * c(sCH4) 
    w(r21f) = k(r21f) * cqss(sqssCH2GL1G) * c(sO2) 
    w(r22f) = k(r22f) * cqss(sqssCH2GL1G) * c(sO2) 
    w(r23f) = k(r23f) * cqss(sqssCH2GL1G) * c(sO) 
    w(r24f) = k(r24f) * cqss(sqssCH2GL1G) * c(sO) 
    w(r25f) = k(r25f) * cqss(sqssCH2GL1G) * c(sH2) 
    w(r26f) = k(r26f) * cqss(sqssCH2GL1G) * c(sOH) 
    w(r27f) = k(r27f) * cqss(sqssCH2GL1G) * c(sCO2) 
    w(r28f) = k(r28f) * cqss(sqssCH2GL1G) * c(sH) 
    w(r29f) = k(r29f) * cqss(sqssCH2GL1G) * c(sO2) 
    w(r30f) = k(r30f) * cqss(sqssCH2GL1G) * c(sO2) 
    w(r31f) = k(r31f) * cqss(sqssCH2GL1G) * c(sO) 
    w(r32f) = k(r32f) * c(sCH3) * c(sO2) 
    w(r33f) = k(r33f) * c(sCH3) * c(sO2) 
    w(r34f) = k(r34f) * c(sCH3) * c(sO) 
    w(r35f) = k(r35f) * c(sCH3) * c(sOH) 
    w(r36f) = k(r36f) * c(sCH3) * c(sOH) 
    w(r37f) = k(r37f) * c(sCH3) * c(sOH) 
    w(r38f) = k(r38f) * c(sCH3) * c(sOH) 
    w(r39f) = k(r39f) * c(sCH3) * c(sHO2) 
    w(r40f) = k(r40f) * cqss(sqssCH3OH) 
    w(r41f) = k(r41f) * cqss(sqssCH3OH) 
    w(r42f) = k(r42f) * cqss(sqssCH3OH) * c(sH) 
    w(r43f) = k(r43f) * cqss(sqssCH3OH) * c(sH) 
    w(r44f) = k(r44f) * cqss(sqssCH3OH) * c(sO) 
    w(r45f) = k(r45f) * cqss(sqssCH3OH) * c(sO) 
    w(r46f) = k(r46f) * cqss(sqssCH3OH) * c(sOH) 
    w(r47f) = k(r47f) * cqss(sqssCH3OH) * c(sOH) 
    w(r48f) = k(r48f) * c(sCH3) * cqss(sqssCH3OH) 
    w(r49f) = k(r49f) * cqss(sqssCH2OH) * c(sO2) 
    w(r50f) = k(r50f) * cqss(sqssCH2OH) * c(sO2) 
    w(r51f) = k(r51f) * cqss(sqssCH2OH) * c(sH) 
    w(r52f) = k(r52f) * cqss(sqssCH2OH) * c(sOH) 
    w(r53f) = k(r53f) * cqss(sqssCH2OH) * c(sO) 
    w(r54f) = k(r54f) * cqss(sqssCH3O) * c(sO2) 
    w(r55f) = k(r55f) * cqss(sqssCH3O) * c(sH) 
    w(r56f) = k(r56f) * c(sCH3) * cqss(sqssCH3O) 
    w(r57f) = k(r57f) * c(sH) * cqss(sqssHCO) 
    w(r58f) = k(r58f) * c(sCO) * c(sH2) 
    w(r59f) = k(r59f) * c(sCH2O) * c(sO) 
    w(r60f) = k(r60f) * c(sCH2O) * c(sH) 
    w(r61f) = k(r61f) * c(sCH2O) * c(sOH) 
    w(r62f) = k(r62f) * c(sCH2O) * c(sCH3) 
    w(r63f) = k(r63f) * cqss(sqssHCO) * m(mM63)
    w(r64f) = k(r64f) * cqss(sqssHCO) * c(sO2) 
    w(r65f) = k(r65f) * cqss(sqssHCO) * c(sO) 
    w(r66f) = k(r66f) * c(sH) * cqss(sqssHCO) 
    w(r67f) = k(r67f) * cqss(sqssHCO) * c(sOH) 
    w(r68f) = k(r68f) * c(sCH3) * cqss(sqssHCO) 
    w(r69f) = k(r69f) * cqss(sqssHCO) * c(sO) 
    w(r70f) = k(r70f) * c(sCH2O) * c(sH) 
    w(r71f) = k(r71f) * cqss(sqssCH3O) 
    w(r72f) = k(r72f) * c(sCH3)**2.0_pr 
    w(r73f) = k(r73f) * cqss(sqssC2H5) * c(sH) 
    w(r74f) = k(r74f) * c(sC2H6) * c(sO) 
    w(r75f) = k(r75f) * c(sC2H6) * c(sH) 
    w(r76f) = k(r76f) * c(sC2H6) * c(sOH) 
    w(r77f) = k(r77f) * c(sC2H6) * c(sCH3) 
    w(r78f) = k(r78f) * c(sC2H4) * c(sH) 
    w(r79f) = k(r79f) * cqss(sqssC2H5) * c(sCH3) 
    w(r80f) = k(r80f) * c(sCH3)**2.0_pr 
    w(r81f) = k(r81f) * cqss(sqssC2H3) * c(sH) 
    w(r82f) = k(r82f) * c(sC2H4) * m(mM82)
    w(r83f) = k(r83f) * c(sC2H4) * c(sH) 
    w(r84f) = k(r84f) * c(sC2H4) * c(sOH) 
    w(r85f) = k(r85f) * c(sC2H4) * c(sCH3) 
    w(r86f) = k(r86f) * c(sC2H4) * c(sCH3) 
    w(r87f) = k(r87f) * c(sC2H4) * c(sO) 
    w(r88f) = k(r88f) * cqss(sqssCH2GL1G) * c(sCH3) 
    w(r89f) = k(r89f) * cqss(sqssC2H2) * c(sH) 
    w(r90f) = k(r90f) * cqss(sqssC2H3) * c(sO2) 
    w(r91f) = k(r91f) * cqss(sqssC2H3) * c(sO2) 
    w(r92f) = k(r92f) * cqss(sqssC2H3) * c(sO2) 
    w(r93f) = k(r93f) * cqss(sqssC2H3) * c(sO2) 
    w(r94f) = k(r94f) * cqss(sqssC2H3) * c(sO2) 
    w(r95f) = k(r95f) * cqss(sqssC2H3) * c(sO2) 
    w(r96f) = k(r96f) * cqss(sqssC2H3) * c(sO2) 
    w(r97f) = k(r97f) * cqss(sqssC2H3) * c(sO2) 
    w(r98f) = k(r98f) * cqss(sqssC2H3) * c(sO2) 
    w(r99f) = k(r99f) * cqss(sqssC2H3) * c(sO2) 
    w(r100f) = k(r100f) * cqss(sqssC2H3) * c(sO2) 
    w(r101f) = k(r101f) * cqss(sqssC2H3) * c(sO2) 
    w(r102f) = k(r102f) * cqss(sqssC2H3) * c(sH) 
    w(r103f) = k(r103f) * cqss(sqssC2H3) * c(sOH) 
    w(r104f) = k(r104f) * cqss(sqssC2H2) * c(sO) 
    w(r105f) = k(r105f) * cqss(sqssC2H2) * c(sOH) 
    w(r106f) = k(r106f) * cqss(sqssC2H2) * c(sOH) 
    w(r107f) = k(r107f) * cqss(sqssCH2CO) 
    w(r108f) = k(r108f) * cqss(sqssC2H3) * c(sO) 
    w(r109f) = k(r109f) * cqss(sqssCH2CO) * c(sH) 
    w(r110f) = k(r110f) * cqss(sqssCH2CO) * c(sOH) 
    w(r111f) = k(r111f) * c(sC2H4) * cqss(sqssCH2GL1G) 
    w(r112f) = k(r112f) * c(sC2H4) * cqss(sqssCH2GL1G) 
    w(r113f) = k(r113f) * cqss(sqssC2H2) * c(sO) 
    w(r114f) = k(r114f) * cqss(sqssCH2CO) * c(sO) 
    w(r115f) = k(r115f) * cqss(sqssCH2CO) * c(sOH) 
    w(r116f) = k(r116f) * c(sO) * c(sOH) * m(mM116)
    w(r117f) = k(r117f) * cqss(sqssC2H5) * c(sO2) 
    w(r118f) = k(r118f) * cqss(sqssCH2GL1G) * c(sO) 
    w(r119f) = k(r119f) * cqss(sqssCH2GL1G) * c(sOH) 
    w(r120f) = k(r120f) * cqss(sqssCH2GL1G) * c(sCO2) 
    w(r121f) = k(r121f) * cqss(sqssCH2GL1G) * c(sO) 
    w(r122f) = k(r122f) * cqss(sqssCH2GL1G) * c(sCH4) 
    w(r123f) = k(r123f) * c(sCH3)**2.0_pr 
    w(r124f) = k(r124f) * c(sC2H6) 
    w(r125f) = k(r125f) * c(sCH2O) * c(sO) 
    w(r126f) = k(r126f) * c(sCH2O) * c(sOH) 
    w(r127f) = k(r127f) * cqss(sqssC2H2) * c(sHO2) 
    w(r128f) = k(r128f) * cqss(sqssCH3O) * c(sCO) 
    w(r129f) = k(r129f) * cqss(sqssC2H2) * c(sO2) 
    w(r130f) = k(r130f) * c(sC2H4) * c(sO2) 
    w(r131f) = k(r131f) * cqss(sqssC2H2) * c(sO2) 
    w(r132f) = k(r132f) * c(sC2H4) * c(sO2) 
    w(r133f) = k(r133f) * c(sCH3) * c(sO) * m(mM133)
    w(r134f) = k(r134f) * cqss(sqssCH2OH) * c(sCH3) 
    w(r135f) = k(r135f) * c(sC2H4) * c(sO) 
    w(r136f) = k(r136f) * cqss(sqssNH2) * c(sNO) 
    w(r137f) = k(r137f) * cqss(sqssNH2) * c(sNO) 
    w(r138f) = k(r138f) * cqss(sqssNH) * c(sO) 
    w(r139f) = k(r139f) * cqss(sqssNH) * c(sNO) 
    w(r140f) = k(r140f) * cqss(sqssNH) * c(sNO) 
    w(r141f) = k(r141f) * c(sN2) * c(sO) 
    w(r142f) = k(r142f) * c(sHO2) * c(sNO) 
    w(r143f) = k(r143f) * c(sH) * c(sNO) 
    w(r144f) = k(r144f) * c(sH) * c(sNO2) 
    w(r145f) = k(r145f) * c(sNO2) * c(sO) 
    w(r146f) = k(r146f) * c(sNO2) * m(mM146)
    w(r147f) = k(r147f) * cqss(sqssHNO) * c(sOH) 
    w(r148f) = k(r148f) * c(sH) * cqss(sqssHNO) 
    w(r149f) = k(r149f) * cqss(sqssN) * c(sO2) 
    w(r150f) = k(r150f) * cqss(sqssN) * c(sOH) 
    w(r151f) = k(r151f) * c(sN2O) * c(sO) 
    w(r1b) = k(r1b) * c(sH) * c(sOH) 
    w(r2b) = k(r2b) * c(sH) * c(sH2O) 
    w(r3b) = k(r3b) * c(sO) * c(sOH) 
    w(r4b) = k(r4b) * c(sH2O) * m(mM4)
    w(r5b) = k(r5b) * c(sOH)**2.0_pr 
    w(r6b) = k(r6b) * c(sOH)**2.0_pr 
    w(r7b) = k(r7b) * c(sH2) * c(sO2) 
    w(r8b) = k(r8b) * c(sO2) * c(sOH) 
    w(r9b) = k(r9b) * c(sH2O) * c(sO2) 
    w(r10b) = k(r10b) * c(sH2O) * c(sO2) 
    w(r11b) = k(r11b) * c(sHO2) 
    w(r12b) = k(r12b) * c(sCO2) 
    w(r13b) = k(r13b) * c(sCO2) * c(sH) 
    w(r14b) = k(r14b) * c(sCO2) * c(sH) 
    w(r15b) = k(r15b) * c(sCH4) 
    w(r16b) = k(r16b) * c(sCH3) * c(sH2) 
    w(r17b) = k(r17b) * c(sCH3) * c(sOH) 
    w(r18b) = k(r18b) * c(sCH3) * c(sH2O) 
    w(r19b) = k(r19b) * c(sCH4) * c(sO2) 
    w(r20b) = k(r20b) * c(sCH3)**2.0_pr 
    w(r22b) = k(r22b) * c(sCO) * c(sH2O) 
    w(r23b) = k(r23b) * c(sCO) * c(sH2) 
    w(r24b) = k(r24b) * c(sH) * cqss(sqssHCO) 
    w(r25b) = k(r25b) * c(sCH3) * c(sH) 
    w(r26b) = k(r26b) * c(sCH2O) * c(sH) 
    w(r27b) = k(r27b) * c(sCH2O) * c(sCO) 
    w(r28b) = k(r28b) * c(sCH3) 
    w(r29b) = k(r29b) * cqss(sqssHCO) * c(sOH) 
    w(r32b) = k(r32b) * cqss(sqssCH3O) * c(sO) 
    w(r33b) = k(r33b) * c(sCH2O) * c(sOH) 
    w(r34b) = k(r34b) * c(sCH2O) * c(sH) 
    w(r35b) = k(r35b) * cqss(sqssCH2GL1G) * c(sH2O) 
    w(r36b) = k(r36b) * cqss(sqssCH2OH) * c(sH) 
    w(r37b) = k(r37b) * cqss(sqssCH3O) * c(sH) 
    w(r38b) = k(r38b) * cqss(sqssCH2GL1G) * c(sH2O) 
    w(r39b) = k(r39b) * cqss(sqssCH3O) * c(sOH) 
    w(r40b) = k(r40b) * c(sCH3) * c(sOH) 
    w(r41b) = k(r41b) * cqss(sqssCH2GL1G) * c(sH2O) 
    w(r42b) = k(r42b) * cqss(sqssCH3O) * c(sH2) 
    w(r43b) = k(r43b) * cqss(sqssCH2OH) * c(sH2) 
    w(r44b) = k(r44b) * cqss(sqssCH3O) * c(sOH) 
    w(r45b) = k(r45b) * cqss(sqssCH2OH) * c(sOH) 
    w(r46b) = k(r46b) * cqss(sqssCH3O) * c(sH2O) 
    w(r47b) = k(r47b) * cqss(sqssCH2OH) * c(sH2O) 
    w(r48b) = k(r48b) * cqss(sqssCH3O) * c(sCH4) 
    w(r49b) = k(r49b) * c(sCH2O) * c(sHO2) 
    w(r50b) = k(r50b) * c(sCH2O) * c(sHO2) 
    w(r51b) = k(r51b) * c(sCH2O) * c(sH2) 
    w(r52b) = k(r52b) * c(sCH2O) * c(sH2O) 
    w(r53b) = k(r53b) * c(sCH2O) * c(sOH) 
    w(r54b) = k(r54b) * c(sCH2O) * c(sHO2) 
    w(r55b) = k(r55b) * c(sCH2O) * c(sH2) 
    w(r56b) = k(r56b) * c(sCH2O) * c(sCH4) 
    w(r57b) = k(r57b) * c(sCH2O) 
    w(r58b) = k(r58b) * c(sCH2O) 
    w(r59b) = k(r59b) * cqss(sqssHCO) * c(sOH) 
    w(r60b) = k(r60b) * c(sH2) * cqss(sqssHCO) 
    w(r61b) = k(r61b) * c(sH2O) * cqss(sqssHCO) 
    w(r62b) = k(r62b) * c(sCH4) * cqss(sqssHCO) 
    w(r63b) = k(r63b) * c(sCO) * c(sH) * m(mM63)
    w(r64b) = k(r64b) * c(sCO) * c(sHO2) 
    w(r65b) = k(r65b) * c(sCO) * c(sOH) 
    w(r66b) = k(r66b) * c(sCO) * c(sH2) 
    w(r67b) = k(r67b) * c(sCO) * c(sH2O) 
    w(r68b) = k(r68b) * c(sCH4) * c(sCO) 
    w(r69b) = k(r69b) * c(sCO2) * c(sH) 
    w(r70b) = k(r70b) * cqss(sqssCH2OH) 
    w(r71b) = k(r71b) * c(sCH2O) * c(sH) 
    w(r72b) = k(r72b) * c(sC2H6) 
    w(r73b) = k(r73b) * c(sC2H6) 
    w(r74b) = k(r74b) * cqss(sqssC2H5) * c(sOH) 
    w(r75b) = k(r75b) * cqss(sqssC2H5) * c(sH2) 
    w(r76b) = k(r76b) * cqss(sqssC2H5) * c(sH2O) 
    w(r77b) = k(r77b) * cqss(sqssC2H5) * c(sCH4) 
    w(r78b) = k(r78b) * cqss(sqssC2H5) 
    w(r79b) = k(r79b) * c(sC2H4) * c(sCH4) 
    w(r80b) = k(r80b) * cqss(sqssC2H5) * c(sH) 
    w(r81b) = k(r81b) * c(sC2H4) 
    w(r82b) = k(r82b) * cqss(sqssC2H2) * c(sH2) * m(mM82)
    w(r83b) = k(r83b) * cqss(sqssC2H3) * c(sH2) 
    w(r84b) = k(r84b) * cqss(sqssC2H3) * c(sH2O) 
    w(r85b) = k(r85b) * cqss(sqssC2H3) * c(sCH4) 
    w(r86b) = k(r86b) * cqss(sqssC2H3) * c(sCH4) 
    w(r87b) = k(r87b) * c(sCH3) * cqss(sqssHCO) 
    w(r88b) = k(r88b) * c(sC2H4) * c(sH) 
    w(r89b) = k(r89b) * cqss(sqssC2H3) 
    w(r90b) = k(r90b) * cqss(sqssC2H2) * c(sHO2) 
    w(r91b) = k(r91b) * cqss(sqssC2H2) * c(sHO2) 
    w(r92b) = k(r92b) * cqss(sqssCH2CO) * c(sOH) 
    w(r93b) = k(r93b) * cqss(sqssCH2CO) * c(sOH) 
    w(r94b) = k(r94b) * c(sCH2O) * cqss(sqssHCO) 
    w(r95b) = k(r95b) * c(sCH2O) * cqss(sqssHCO) 
    w(r98b) = k(r98b) * cqss(sqssCH3O) * c(sCO) 
    w(r99b) = k(r99b) * cqss(sqssCH3O) * c(sCO) 
    w(r100b) = k(r100b) * c(sCH3) * c(sCO2) 
    w(r101b) = k(r101b) * c(sCH3) * c(sCO2) 
    w(r102b) = k(r102b) * cqss(sqssC2H2) * c(sH2) 
    w(r103b) = k(r103b) * cqss(sqssC2H2) * c(sH2O) 
    w(r104b) = k(r104b) * cqss(sqssCH2GL1G) * c(sCO) 
    w(r105b) = k(r105b) * cqss(sqssCH2CO) * c(sH) 
    w(r106b) = k(r106b) * c(sCH3) * c(sCO) 
    w(r107b) = k(r107b) * cqss(sqssCH2GL1G) * c(sCO) 
    w(r108b) = k(r108b) * cqss(sqssCH2CO) * c(sH) 
    w(r109b) = k(r109b) * c(sCH3) * c(sCO) 
    w(r110b) = k(r110b) * cqss(sqssCH2OH) * c(sCO) 
    w(r111b) = k(r111b) * cqss(sqssC2H3) * c(sCH3) 
    w(r112b) = k(r112b) * cqss(sqssC2H3) * c(sCH3) 
    w(r116b) = k(r116b) * c(sHO2) * m(mM116)
    w(r118b) = k(r118b) * c(sCO) * c(sH2) 
    w(r119b) = k(r119b) * c(sCH2O) * c(sH) 
    w(r120b) = k(r120b) * c(sCH2O) * c(sCO) 
    w(r121b) = k(r121b) * c(sCO) * c(sH)**2.0_pr 
    w(r122b) = k(r122b) * c(sCH3)**2.0_pr 
    w(r124b) = k(r124b) * c(sC2H4) * c(sH2) 
    w(r128b) = k(r128b) * c(sCH3) * c(sCO2) 
    w(r135b) = k(r135b) * cqss(sqssC2H3) * c(sOH) 
    w(r136b) = k(r136b) * c(sH2O) * c(sN2) 
    w(r137b) = k(r137b) * cqss(sqssN2H) * c(sOH) 
    w(r138b) = k(r138b) * c(sH) * c(sNO) 
    w(r139b) = k(r139b) * c(sH) * c(sN2O) 
    w(r140b) = k(r140b) * c(sN2) * c(sOH) 
    w(r141b) = k(r141b) * cqss(sqssN) * c(sNO) 
    w(r142b) = k(r142b) * c(sNO2) * c(sOH) 
    w(r143b) = k(r143b) * cqss(sqssHNO) 
    w(r144b) = k(r144b) * c(sNO) * c(sOH) 
    w(r145b) = k(r145b) * c(sNO) * c(sO2) 
    w(r146b) = k(r146b) * c(sNO) * c(sO) * m(mM146)
    w(r147b) = k(r147b) * c(sH2O) * c(sNO) 
    w(r148b) = k(r148b) * c(sH2) * c(sNO) 
    w(r149b) = k(r149b) * c(sNO) * c(sO) 
    w(r150b) = k(r150b) * c(sH) * c(sNO) 
    w(r151b) = k(r151b) * c(sNO)**2.0_pr 
  
    return
  end subroutine get_reaction_rates
  
  ! ----------------------------------------------- !
  ! Evaluate production rates                       !
  ! ----------------------------------------------- !
  subroutine get_production_rates(cdot,w)
    implicit none

    real(pr), dimension(nspec) :: cdot
    real(pr), dimension(nreac + nreac_reverse) :: w

    cdot(sN2) = 0.0_pr &
         + w(r136f) &
         - w(r136b) &
         + w(r140f) &
         - w(r140b) &
         - w(r141f) &
         + w(r141b) 

    cdot(sH2) = 0.0_pr &
         - w(r1f) &
         + w(r1b) &
         - w(r2f) &
         + w(r2b) &
         + w(r7f) &
         - w(r7b) &
         + w(r16f) &
         - w(r16b) &
         + w(r23f) &
         - w(r23b) &
         - w(r25f) &
         + w(r25b) &
         + w(r42f) &
         - w(r42b) &
         + w(r43f) &
         - w(r43b) &
         + w(r51f) &
         - w(r51b) &
         + w(r55f) &
         - w(r55b) &
         - w(r58f) &
         + w(r58b) &
         + w(r60f) &
         - w(r60b) &
         + w(r66f) &
         - w(r66b) &
         + w(r75f) &
         - w(r75b) &
         + w(r82f) &
         - w(r82b) &
         + w(r83f) &
         - w(r83b) &
         + w(r102f) &
         - w(r102b) &
         + w(r118f) &
         - w(r118b) &
         + w(r123f) &
         + w(r124f) &
         - w(r124b) &
         + w(r126f) &
         + w(r148f) &
         - w(r148b) 

    cdot(sH) = 0.0_pr &
         + w(r1f) &
         - w(r1b) &
         + w(r2f) &
         - w(r2b) &
         - w(r3f) &
         + w(r3b) &
         - w(r4f) &
         + w(r4b) &
         - w(r6f) &
         + w(r6b) &
         - w(r7f) &
         + w(r7b) &
         - w(r11f) &
         + w(r11b) &
         + w(r13f) &
         - w(r13b) &
         + w(r14f) &
         - w(r14b) &
         - w(r15f) &
         + w(r15b) &
         - w(r16f) &
         + w(r16b) &
         + w(r21f) &
         + w(r24f) &
         - w(r24b) &
         + w(r25f) &
         - w(r25b) &
         + w(r26f) &
         - w(r26b) &
         - w(r28f) &
         + w(r28b) &
         + 2.0_pr * w(r30f) &
         + 2.0_pr * w(r31f) &
         + w(r34f) &
         - w(r34b) &
         + w(r36f) &
         - w(r36b) &
         + w(r37f) &
         - w(r37b) &
         - w(r42f) &
         + w(r42b) &
         - w(r43f) &
         + w(r43b) &
         - w(r51f) &
         + w(r51b) &
         - w(r55f) &
         + w(r55b) &
         - w(r57f) &
         + w(r57b) &
         - w(r60f) &
         + w(r60b) &
         + w(r63f) &
         - w(r63b) &
         - w(r66f) &
         + w(r66b) &
         + w(r69f) &
         - w(r69b) &
         - w(r70f) &
         + w(r70b) &
         + w(r71f) &
         - w(r71b) &
         - w(r73f) &
         + w(r73b) &
         - w(r75f) &
         + w(r75b) &
         - w(r78f) &
         + w(r78b) &
         + w(r80f) &
         - w(r80b) &
         - w(r81f) &
         + w(r81b) &
         - w(r83f) &
         + w(r83b) &
         + w(r88f) &
         - w(r88b) &
         - w(r89f) &
         + w(r89b) &
         + w(r96f) &
         + w(r97f) &
         - w(r102f) &
         + w(r102b) &
         + w(r105f) &
         - w(r105b) &
         + w(r108f) &
         - w(r108b) &
         - w(r109f) &
         + w(r109b) &
         + w(r119f) &
         - w(r119b) &
         + 2.0_pr * w(r121f) &
         - 2.0_pr * w(r121b) &
         + 2.0_pr * w(r125f) &
         + w(r126f) &
         + w(r138f) &
         - w(r138b) &
         + w(r139f) &
         - w(r139b) &
         - w(r143f) &
         + w(r143b) &
         - w(r144f) &
         + w(r144b) &
         - w(r148f) &
         + w(r148b) &
         + w(r150f) &
         - w(r150b) 

    cdot(sO2) = 0.0_pr &
         - w(r3f) &
         + w(r3b) &
         + w(r7f) &
         - w(r7b) &
         + w(r8f) &
         - w(r8b) &
         + w(r9f) &
         - w(r9b) &
         + w(r10f) &
         - w(r10b) &
         - w(r11f) &
         + w(r11b) &
         + w(r19f) &
         - w(r19b) &
         - w(r21f) &
         - w(r22f) &
         + w(r22b) &
         - w(r29f) &
         + w(r29b) &
         - w(r30f) &
         - w(r32f) &
         + w(r32b) &
         - w(r33f) &
         + w(r33b) &
         - w(r49f) &
         + w(r49b) &
         - w(r50f) &
         + w(r50b) &
         - w(r54f) &
         + w(r54b) &
         - w(r64f) &
         + w(r64b) &
         - w(r90f) &
         + w(r90b) &
         - w(r91f) &
         + w(r91b) &
         - w(r92f) &
         + w(r92b) &
         - w(r93f) &
         + w(r93b) &
         - w(r94f) &
         + w(r94b) &
         - w(r95f) &
         + w(r95b) &
         - w(r96f) &
         - w(r97f) &
         - w(r98f) &
         + w(r98b) &
         - w(r99f) &
         + w(r99b) &
         - w(r100f) &
         + w(r100b) &
         - w(r101f) &
         + w(r101b) &
         - w(r117f) &
         - w(r129f) &
         - w(r130f) &
         - w(r131f) &
         - w(r132f) &
         + w(r145f) &
         - w(r145b) &
         - w(r149f) &
         + w(r149b) 

    cdot(sO) = 0.0_pr &
         - w(r1f) &
         + w(r1b) &
         + w(r3f) &
         - w(r3b) &
         - w(r5f) &
         + w(r5b) &
         - w(r8f) &
         + w(r8b) &
         - w(r12f) &
         + w(r12b) &
         - w(r17f) &
         + w(r17b) &
         - w(r23f) &
         + w(r23b) &
         - w(r24f) &
         + w(r24b) &
         - w(r31f) &
         + w(r32f) &
         - w(r32b) &
         - w(r34f) &
         + w(r34b) &
         - w(r44f) &
         + w(r44b) &
         - w(r45f) &
         + w(r45b) &
         - w(r53f) &
         + w(r53b) &
         - w(r59f) &
         + w(r59b) &
         - w(r65f) &
         + w(r65b) &
         - w(r69f) &
         + w(r69b) &
         - w(r74f) &
         + w(r74b) &
         - w(r87f) &
         + w(r87b) &
         - w(r104f) &
         + w(r104b) &
         - w(r108f) &
         + w(r108b) &
         - w(r113f) &
         - w(r114f) &
         - w(r116f) &
         + w(r116b) &
         - w(r118f) &
         + w(r118b) &
         - w(r121f) &
         + w(r121b) &
         - w(r125f) &
         - w(r133f) &
         - w(r135f) &
         + w(r135b) &
         - w(r138f) &
         + w(r138b) &
         - w(r141f) &
         + w(r141b) &
         - w(r145f) &
         + w(r145b) &
         + w(r146f) &
         - w(r146b) &
         + w(r149f) &
         - w(r149b) &
         - w(r151f) &
         + w(r151b) 

    cdot(sH2O) = 0.0_pr &
         + w(r2f) &
         - w(r2b) &
         + w(r4f) &
         - w(r4b) &
         - w(r5f) &
         + w(r5b) &
         + w(r9f) &
         - w(r9b) &
         + w(r10f) &
         - w(r10b) &
         + w(r18f) &
         - w(r18b) &
         + w(r22f) &
         - w(r22b) &
         + w(r35f) &
         - w(r35b) &
         + w(r38f) &
         - w(r38b) &
         + w(r41f) &
         - w(r41b) &
         + w(r46f) &
         - w(r46b) &
         + w(r47f) &
         - w(r47b) &
         + w(r52f) &
         - w(r52b) &
         + w(r61f) &
         - w(r61b) &
         + w(r67f) &
         - w(r67b) &
         + w(r76f) &
         - w(r76b) &
         + w(r84f) &
         - w(r84b) &
         + w(r103f) &
         - w(r103b) &
         + w(r136f) &
         - w(r136b) &
         + w(r147f) &
         - w(r147b) 

    cdot(sOH) = 0.0_pr &
         + w(r1f) &
         - w(r1b) &
         - w(r2f) &
         + w(r2b) &
         + w(r3f) &
         - w(r3b) &
         - w(r4f) &
         + w(r4b) &
         + 2.0_pr * w(r5f) &
         - 2.0_pr * w(r5b) &
         + 2.0_pr * w(r6f) &
         - 2.0_pr * w(r6b) &
         + w(r8f) &
         - w(r8b) &
         - w(r9f) &
         + w(r9b) &
         - w(r10f) &
         + w(r10b) &
         - w(r13f) &
         + w(r13b) &
         - w(r14f) &
         + w(r14b) &
         + w(r17f) &
         - w(r17b) &
         - w(r18f) &
         + w(r18b) &
         + w(r21f) &
         - w(r26f) &
         + w(r26b) &
         + w(r29f) &
         - w(r29b) &
         + w(r33f) &
         - w(r33b) &
         - w(r35f) &
         + w(r35b) &
         - w(r36f) &
         + w(r36b) &
         - w(r37f) &
         + w(r37b) &
         - w(r38f) &
         + w(r38b) &
         + w(r39f) &
         - w(r39b) &
         + w(r40f) &
         - w(r40b) &
         + w(r44f) &
         - w(r44b) &
         + w(r45f) &
         - w(r45b) &
         - w(r46f) &
         + w(r46b) &
         - w(r47f) &
         + w(r47b) &
         - w(r52f) &
         + w(r52b) &
         + w(r53f) &
         - w(r53b) &
         + w(r59f) &
         - w(r59b) &
         - w(r61f) &
         + w(r61b) &
         + w(r65f) &
         - w(r65b) &
         - w(r67f) &
         + w(r67b) &
         + w(r74f) &
         - w(r74b) &
         - w(r76f) &
         + w(r76b) &
         - w(r84f) &
         + w(r84b) &
         + w(r92f) &
         - w(r92b) &
         + w(r93f) &
         - w(r93b) &
         - w(r103f) &
         + w(r103b) &
         - w(r105f) &
         + w(r105b) &
         - w(r106f) &
         + w(r106b) &
         - w(r110f) &
         + w(r110b) &
         - w(r115f) &
         - w(r116f) &
         + w(r116b) &
         - w(r119f) &
         + w(r119b) &
         - w(r126f) &
         + w(r135f) &
         - w(r135b) &
         + w(r137f) &
         - w(r137b) &
         + w(r140f) &
         - w(r140b) &
         + w(r142f) &
         - w(r142b) &
         + w(r144f) &
         - w(r144b) &
         - w(r147f) &
         + w(r147b) &
         - w(r150f) &
         + w(r150b) 

    cdot(sCO) = 0.0_pr &
         - w(r12f) &
         + w(r12b) &
         - w(r13f) &
         + w(r13b) &
         - w(r14f) &
         + w(r14b) &
         + w(r21f) &
         + w(r22f) &
         - w(r22b) &
         + w(r23f) &
         - w(r23b) &
         + w(r27f) &
         - w(r27b) &
         + w(r31f) &
         - w(r58f) &
         + w(r58b) &
         + w(r63f) &
         - w(r63b) &
         + w(r64f) &
         - w(r64b) &
         + w(r65f) &
         - w(r65b) &
         + w(r66f) &
         - w(r66b) &
         + w(r67f) &
         - w(r67b) &
         + w(r68f) &
         - w(r68b) &
         + w(r96f) &
         + w(r97f) &
         + w(r98f) &
         - w(r98b) &
         + w(r99f) &
         - w(r99b) &
         + w(r104f) &
         - w(r104b) &
         + w(r106f) &
         - w(r106b) &
         + w(r107f) &
         - w(r107b) &
         + w(r109f) &
         - w(r109b) &
         + w(r110f) &
         - w(r110b) &
         + w(r118f) &
         - w(r118b) &
         + w(r120f) &
         - w(r120b) &
         + w(r121f) &
         - w(r121b) &
         - w(r128f) &
         + w(r128b) &
         + w(r129f) 

    cdot(sCO2) = 0.0_pr &
         + w(r12f) &
         - w(r12b) &
         + w(r13f) &
         - w(r13b) &
         + w(r14f) &
         - w(r14b) &
         - w(r27f) &
         + w(r27b) &
         + w(r30f) &
         + w(r69f) &
         - w(r69b) &
         + w(r100f) &
         - w(r100b) &
         + w(r101f) &
         - w(r101b) &
         + w(r115f) &
         - w(r120f) &
         + w(r120b) &
         + w(r125f) &
         + w(r126f) &
         + w(r128f) &
         - w(r128b) 

    cdot(sCH4) = 0.0_pr &
         + w(r15f) &
         - w(r15b) &
         - w(r16f) &
         + w(r16b) &
         - w(r17f) &
         + w(r17b) &
         - w(r18f) &
         + w(r18b) &
         + w(r19f) &
         - w(r19b) &
         - w(r20f) &
         + w(r20b) &
         + w(r48f) &
         - w(r48b) &
         + w(r56f) &
         - w(r56b) &
         + w(r62f) &
         - w(r62b) &
         + w(r68f) &
         - w(r68b) &
         + w(r77f) &
         - w(r77b) &
         + w(r79f) &
         - w(r79b) &
         + w(r85f) &
         - w(r85b) &
         + w(r86f) &
         - w(r86b) &
         - w(r122f) &
         + w(r122b) &
         + w(r134f) 

    cdot(sCH3) = 0.0_pr &
         - w(r15f) &
         + w(r15b) &
         + w(r16f) &
         - w(r16b) &
         + w(r17f) &
         - w(r17b) &
         + w(r18f) &
         - w(r18b) &
         - w(r19f) &
         + w(r19b) &
         + 2.0_pr * w(r20f) &
         - 2.0_pr * w(r20b) &
         + w(r25f) &
         - w(r25b) &
         + w(r28f) &
         - w(r28b) &
         - w(r32f) &
         + w(r32b) &
         - w(r33f) &
         + w(r33b) &
         - w(r34f) &
         + w(r34b) &
         - w(r35f) &
         + w(r35b) &
         - w(r36f) &
         + w(r36b) &
         - w(r37f) &
         + w(r37b) &
         - w(r38f) &
         + w(r38b) &
         - w(r39f) &
         + w(r39b) &
         + w(r40f) &
         - w(r40b) &
         - w(r48f) &
         + w(r48b) &
         - w(r56f) &
         + w(r56b) &
         - w(r62f) &
         + w(r62b) &
         - w(r68f) &
         + w(r68b) &
         -2.0_pr * w(r72f) &
         + 2.0_pr * w(r72b) &
         - w(r77f) &
         + w(r77b) &
         - w(r79f) &
         + w(r79b) &
         -2.0_pr * w(r80f) &
         + 2.0_pr * w(r80b) &
         - w(r85f) &
         + w(r85b) &
         - w(r86f) &
         + w(r86b) &
         + w(r87f) &
         - w(r87b) &
         - w(r88f) &
         + w(r88b) &
         + w(r100f) &
         - w(r100b) &
         + w(r101f) &
         - w(r101b) &
         + w(r106f) &
         - w(r106b) &
         + w(r109f) &
         - w(r109b) &
         + w(r111f) &
         - w(r111b) &
         + w(r112f) &
         - w(r112b) &
         + w(r115f) &
         + 2.0_pr * w(r122f) &
         - 2.0_pr * w(r122b) &
         -2.0_pr * w(r123f) &
         + w(r128f) &
         - w(r128b) &
         - w(r133f) &
         - w(r134f) 

    cdot(sCH2O) = 0.0_pr &
         + w(r26f) &
         - w(r26b) &
         + w(r27f) &
         - w(r27b) &
         + w(r33f) &
         - w(r33b) &
         + w(r34f) &
         - w(r34b) &
         + w(r49f) &
         - w(r49b) &
         + w(r50f) &
         - w(r50b) &
         + w(r51f) &
         - w(r51b) &
         + w(r52f) &
         - w(r52b) &
         + w(r53f) &
         - w(r53b) &
         + w(r54f) &
         - w(r54b) &
         + w(r55f) &
         - w(r55b) &
         + w(r56f) &
         - w(r56b) &
         + w(r57f) &
         - w(r57b) &
         + w(r58f) &
         - w(r58b) &
         - w(r59f) &
         + w(r59b) &
         - w(r60f) &
         + w(r60b) &
         - w(r61f) &
         + w(r61b) &
         - w(r62f) &
         + w(r62b) &
         - w(r70f) &
         + w(r70b) &
         + w(r71f) &
         - w(r71b) &
         + w(r94f) &
         - w(r94b) &
         + w(r95f) &
         - w(r95b) &
         + w(r96f) &
         + w(r97f) &
         + w(r117f) &
         + w(r119f) &
         - w(r119b) &
         + w(r120f) &
         - w(r120b) &
         - w(r125f) &
         - w(r126f) &
         + w(r127f) &
         + w(r129f) &
         + 2.0_pr * w(r130f) &
         + w(r134f) 

    cdot(sC2H6) = 0.0_pr &
         + w(r72f) &
         - w(r72b) &
         + w(r73f) &
         - w(r73b) &
         - w(r74f) &
         + w(r74b) &
         - w(r75f) &
         + w(r75b) &
         - w(r76f) &
         + w(r76b) &
         - w(r77f) &
         + w(r77b) &
         - w(r124f) &
         + w(r124b) 

    cdot(sHO2) = 0.0_pr &
         - w(r6f) &
         + w(r6b) &
         - w(r7f) &
         + w(r7b) &
         - w(r8f) &
         + w(r8b) &
         - w(r9f) &
         + w(r9b) &
         - w(r10f) &
         + w(r10b) &
         + w(r11f) &
         - w(r11b) &
         - w(r19f) &
         + w(r19b) &
         - w(r39f) &
         + w(r39b) &
         + w(r49f) &
         - w(r49b) &
         + w(r50f) &
         - w(r50b) &
         + w(r54f) &
         - w(r54b) &
         + w(r64f) &
         - w(r64b) &
         + w(r90f) &
         - w(r90b) &
         + w(r91f) &
         - w(r91b) &
         + w(r116f) &
         - w(r116b) &
         - w(r127f) &
         - w(r142f) &
         + w(r142b) 

    cdot(sC2H4) = 0.0_pr &
         - w(r78f) &
         + w(r78b) &
         + w(r79f) &
         - w(r79b) &
         + w(r81f) &
         - w(r81b) &
         - w(r82f) &
         + w(r82b) &
         - w(r83f) &
         + w(r83b) &
         - w(r84f) &
         + w(r84b) &
         - w(r85f) &
         + w(r85b) &
         - w(r86f) &
         + w(r86b) &
         - w(r87f) &
         + w(r87b) &
         + w(r88f) &
         - w(r88b) &
         - w(r111f) &
         + w(r111b) &
         - w(r112f) &
         + w(r112b) &
         + w(r123f) &
         + w(r124f) &
         - w(r124b) &
         - w(r130f) &
         - w(r132f) &
         - w(r135f) &
         + w(r135b) 

    cdot(sNO) = 0.0_pr &
         - w(r136f) &
         + w(r136b) &
         - w(r137f) &
         + w(r137b) &
         + w(r138f) &
         - w(r138b) &
         - w(r139f) &
         + w(r139b) &
         - w(r140f) &
         + w(r140b) &
         + w(r141f) &
         - w(r141b) &
         - w(r142f) &
         + w(r142b) &
         - w(r143f) &
         + w(r143b) &
         + w(r144f) &
         - w(r144b) &
         + w(r145f) &
         - w(r145b) &
         + w(r146f) &
         - w(r146b) &
         + w(r147f) &
         - w(r147b) &
         + w(r148f) &
         - w(r148b) &
         + w(r149f) &
         - w(r149b) &
         + w(r150f) &
         - w(r150b) &
         + 2.0_pr * w(r151f) &
         - 2.0_pr * w(r151b) 

    cdot(sN2O) = 0.0_pr &
         + w(r139f) &
         - w(r139b) &
         - w(r151f) &
         + w(r151b) 

    cdot(sNO2) = 0.0_pr &
         + w(r142f) &
         - w(r142b) &
         - w(r144f) &
         + w(r144b) &
         - w(r145f) &
         + w(r145b) &
         - w(r146f) &
         + w(r146b) 

  
    return
  end subroutine get_production_rates


  ! ----------------------------------------------- !
  ! Evaluation of QSS concentrations                !
  ! ----------------------------------------------- !
  subroutine get_qss(cqss,c,k,M)
    implicit none

    real(pr), dimension(nqss) :: cqss
    real(pr), dimension(nspec) :: c
    real(pr), dimension(nreac + nreac_reverse) :: k
    real(pr), dimension(nTB + nFO) :: M

    integer :: index

    real(pr) :: C2H2_ct
    real(pr) :: C2H2_num
    real(pr) :: C2H2_denom
    real(pr) :: C2H2_CH2GL1G
    real(pr) :: C2H2_C2H3
    real(pr) :: C2H2_CH2CO
    real(pr) :: CH2GL1G_ct
    real(pr) :: CH2GL1G_num
    real(pr) :: CH2GL1G_denom
    real(pr) :: CH2GL1G_C2H2
    real(pr) :: CH2GL1G_CH3OH
    real(pr) :: CH2GL1G_HCO
    real(pr) :: CH2GL1G_C2H3
    real(pr) :: CH2GL1G_CH2CO
    real(pr) :: CH3OH_ct
    real(pr) :: CH3OH_num
    real(pr) :: CH3OH_denom
    real(pr) :: CH3OH_CH2GL1G
    real(pr) :: CH3OH_CH3O
    real(pr) :: CH3OH_CH2OH
    real(pr) :: CH3O_ct
    real(pr) :: CH3O_num
    real(pr) :: CH3O_denom
    real(pr) :: CH3O_CH3OH
    real(pr) :: CH3O_C2H5
    real(pr) :: CH3O_C2H3
    real(pr) :: CH2OH_ct
    real(pr) :: CH2OH_num
    real(pr) :: CH2OH_denom
    real(pr) :: CH2OH_CH3OH
    real(pr) :: CH2OH_CH2CO
    real(pr) :: HCO_ct
    real(pr) :: HCO_num
    real(pr) :: HCO_denom
    real(pr) :: HCO_C2H2
    real(pr) :: HCO_CH2GL1G
    real(pr) :: HCO_C2H3
    real(pr) :: HCO_CH2CO
    real(pr) :: C2H5_ct
    real(pr) :: C2H5_num
    real(pr) :: C2H5_denom
    real(pr) :: C2H3_ct
    real(pr) :: C2H3_num
    real(pr) :: C2H3_denom
    real(pr) :: C2H3_C2H2
    real(pr) :: C2H3_CH2GL1G
    real(pr) :: C2H3_CH3O
    real(pr) :: C2H3_HCO
    real(pr) :: C2H3_CH2CO
    real(pr) :: CH2CO_ct
    real(pr) :: CH2CO_num
    real(pr) :: CH2CO_denom
    real(pr) :: CH2CO_C2H2
    real(pr) :: CH2CO_CH2GL1G
    real(pr) :: CH2CO_CH2OH
    real(pr) :: CH2CO_C2H3
    real(pr) :: HNO_ct
    real(pr) :: HNO_num
    real(pr) :: HNO_denom
    real(pr) :: N_ct
    real(pr) :: N_num
    real(pr) :: N_denom
    real(pr) :: N2H_ct
    real(pr) :: N2H_num
    real(pr) :: N2H_denom
    real(pr) :: N2H_NH2
    real(pr) :: NH2_ct
    real(pr) :: NH2_num
    real(pr) :: NH2_denom
    real(pr) :: NH2_N2H
    real(pr) :: NH_ct
    real(pr) :: NH_num
    real(pr) :: NH_denom
  
    real(pr) :: a_c_a
    real(pr) :: b_i_a
    real(pr) :: b_n_a
    real(pr) :: b_o_a
    real(pr) :: b_q_a
    real(pr) :: b_ad_a
    real(pr) :: b_am_a
    real(pr) :: b_ao_a
    real(pr) :: b_at_a
    real(pr) :: b_au_a
    real(pr) :: b_aw_a
    real(pr) :: b_bb_a
    real(pr) :: b_bc_a
    real(pr) :: b_be_a
    real(pr) :: b_bj_a
    real(pr) :: b_bk_a
    real(pr) :: b_r_b
    real(pr) :: b_u_b
    real(pr) :: b_v_b
    real(pr) :: b_w_b
    real(pr) :: b_z_b
    real(pr) :: b_ad_b
    real(pr) :: b_ah_b
    real(pr) :: b_am_b
    real(pr) :: b_ap_b
    real(pr) :: b_as_b
    real(pr) :: b_at_b
    real(pr) :: b_au_b
    real(pr) :: b_ax_b
    real(pr) :: b_ba_b
    real(pr) :: b_bb_b
    real(pr) :: b_bc_b
    real(pr) :: b_bf_b
    real(pr) :: b_bi_b
    real(pr) :: b_bj_b
    real(pr) :: b_bk_b
    real(pr) :: b_aa_c
    real(pr) :: b_ab_c
    real(pr) :: b_ai_c
    real(pr) :: b_aj_c
    real(pr) :: b_aq_c
    real(pr) :: b_ar_c
    real(pr) :: b_ay_c
    real(pr) :: b_bz_c
    real(pr) :: b_bg_c
    real(pr) :: b_bh_c
    real(pr) :: b_al_d
    real(pr) :: b_at_d
    real(pr) :: b_bb_d
    real(pr) :: b_bj_d
    real(pr) :: b_au_e
    real(pr) :: b_bc_e
    real(pr) :: b_bk_e
    real(pr) :: b_bb_f
    real(pr) :: b_bc_f
    real(pr) :: b_bj_f
    real(pr) :: b_bk_f
    real(pr) :: b_bk_g
    real(pr) :: A_A_A
    real(pr) :: B_A_A
    real(pr) :: B_B_A
    real(pr) :: B_C_A
    real(pr) :: B_D_A
    real(pr) :: B_E_A
    real(pr) :: B_F_A
    real(pr) :: B_G_A
    real(pr) :: B_B_B
    real(pr) :: B_C_B
    real(pr) :: B_D_B
    real(pr) :: B_E_B
    real(pr) :: B_F_B
    real(pr) :: B_G_B
    real(pr) :: B_C_C
    real(pr) :: B_D_C
    real(pr) :: B_E_C
    real(pr) :: B_F_C
    real(pr) :: B_G_C
    real(pr) :: B_D_D
    real(pr) :: B_E_D
    real(pr) :: B_F_D
    real(pr) :: B_G_D
    real(pr) :: B_E_E
    real(pr) :: B_F_E
    real(pr) :: B_G_E
    real(pr) :: B_F_F
    real(pr) :: B_G_F
    real(pr) :: B_G_G

    C2H5_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r73f)* c(sH) &
             + k(r79f)* c(sCH3) &
             + k(r117f)* c(sO2) &
             + k(r74b)* c(sOH) &
             + k(r75b)* c(sH2) &
             + k(r76b)* c(sH2O) &
             + k(r77b)* c(sCH4) &
             + k(r78b)&
             + k(r80b)* c(sH)   )

    C2H5_num = ( 0.0_pr &
             + k(r74f)* c(sC2H6) * c(sO) &
             + k(r75f)* c(sC2H6) * c(sH) &
             + k(r76f)* c(sC2H6) * c(sOH) &
             + k(r77f)* c(sC2H6) * c(sCH3) &
             + k(r78f)* c(sC2H4) * c(sH) &
             + k(r80f) *c(sCH3)** 2.0_pr&
             + k(r73b)* c(sC2H6) &
             + k(r79b)* c(sC2H4) * c(sCH4)   )

    C2H5_ct = C2H5_num / C2H5_denom

    cqss(sqssC2H5) = C2H5_ct  

    HNO_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r147f)* c(sOH) &
             + k(r148f)* c(sH) &
             + k(r143b)  )

    HNO_num = ( 0.0_pr &
             + k(r143f)* c(sH) * c(sNO) &
             + k(r147b)* c(sH2O) * c(sNO) &
             + k(r148b)* c(sH2) * c(sNO)   )

    HNO_ct = HNO_num / HNO_denom

    cqss(sqssHNO) = HNO_ct  

    N_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r149f)* c(sO2) &
             + k(r150f)* c(sOH) &
             + k(r141b)* c(sNO)   )

    N_num = ( 0.0_pr &
             + k(r141f)* c(sN2) * c(sO) &
             + k(r149b)* c(sNO) * c(sO) &
             + k(r150b)* c(sH) * c(sNO)   )

    N_ct = N_num / N_denom

    cqss(sqssN) = N_ct  

    NH2_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r136f)* c(sNO) &
             + k(r137f)* c(sNO)   )

    NH2_num = ( 0.0_pr &
             + k(r136b)* c(sH2O) * c(sN2)   )

    NH2_ct = NH2_num / NH2_denom

    NH2_N2H = - ( 0.0_pr &
          + k(r137b) * c(sOH)  ) / NH2_denom

    N2H_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r137b)* c(sOH)   )

    N2H_num = ( 0.0_pr   )

    N2H_ct = N2H_num / N2H_denom

    N2H_NH2 = - ( 0.0_pr &
          + k(r137f) * c(sNO)  ) / N2H_denom

    a_c_a =  (1.0_pr) - (N2H_NH2) * (NH2_N2H)
    A_A_A =  (NH2_ct) - (N2H_ct) * (NH2_N2H)

    cqss(sqssNH2) = ( A_A_A ) / ( a_c_a )  

    cqss(sqssN2H) = N2H_ct - (N2H_NH2) * cqss(sqssNH2)  

    NH_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r138f)* c(sO) &
             + k(r139f)* c(sNO) &
             + k(r140f)* c(sNO)   )

    NH_num = ( 0.0_pr &
             + k(r138b)* c(sH) * c(sNO) &
             + k(r139b)* c(sH) * c(sN2O) &
             + k(r140b)* c(sN2) * c(sOH)   )

    NH_ct = NH_num / NH_denom

    cqss(sqssNH) = NH_ct  

    CH2CO_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r107f)&
             + k(r109f)* c(sH) &
             + k(r110f)* c(sOH) &
             + k(r114f)* c(sO) &
             + k(r115f)* c(sOH) &
             + k(r92b)* c(sOH) &
             + k(r93b)* c(sOH) &
             + k(r105b)* c(sH) &
             + k(r108b)* c(sH)   )

    CH2CO_num = ( 0.0_pr &
             + k(r109b)* c(sCH3) * c(sCO)   )

    CH2CO_ct = CH2CO_num / CH2CO_denom

    CH2CO_C2H2 = - ( 0.0_pr &
          + k(r105f) * c(sOH) &
          + k(r113f) * c(sO)  ) / CH2CO_denom

    CH2CO_CH2GL1G = - ( 0.0_pr &
          + k(r107b) * c(sCO)  ) / CH2CO_denom

    CH2CO_CH2OH = - ( 0.0_pr &
          + k(r110b) * c(sCO)  ) / CH2CO_denom

    CH2CO_C2H3 = - ( 0.0_pr &
          + k(r92f) * c(sO2) &
          + k(r93f) * c(sO2) &
          + k(r108f) * c(sO)  ) / CH2CO_denom

    C2H3_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r81f)* c(sH) &
             + k(r90f)* c(sO2) &
             + k(r91f)* c(sO2) &
             + k(r92f)* c(sO2) &
             + k(r93f)* c(sO2) &
             + k(r94f)* c(sO2) &
             + k(r95f)* c(sO2) &
             + k(r96f)* c(sO2) &
             + k(r97f)* c(sO2) &
             + k(r98f)* c(sO2) &
             + k(r99f)* c(sO2) &
             + k(r100f)* c(sO2) &
             + k(r101f)* c(sO2) &
             + k(r102f)* c(sH) &
             + k(r103f)* c(sOH) &
             + k(r108f)* c(sO) &
             + k(r83b)* c(sH2) &
             + k(r84b)* c(sH2O) &
             + k(r85b)* c(sCH4) &
             + k(r86b)* c(sCH4) &
             + k(r89b)&
             + k(r111b)* c(sCH3) &
             + k(r112b)* c(sCH3) &
             + k(r135b)* c(sOH)   )

    C2H3_num = ( 0.0_pr &
             + k(r83f)* c(sC2H4) * c(sH) &
             + k(r84f)* c(sC2H4) * c(sOH) &
             + k(r85f)* c(sC2H4) * c(sCH3) &
             + k(r86f)* c(sC2H4) * c(sCH3) &
             + k(r135f)* c(sC2H4) * c(sO) &
             + k(r81b)* c(sC2H4) &
             + k(r100b)* c(sCH3) * c(sCO2) &
             + k(r101b)* c(sCH3) * c(sCO2)   )

    C2H3_ct = C2H3_num / C2H3_denom

    C2H3_C2H2 = - ( 0.0_pr &
          + k(r89f) * c(sH) &
          + k(r90b) * c(sHO2) &
          + k(r91b) * c(sHO2) &
          + k(r102b) * c(sH2) &
          + k(r103b) * c(sH2O)  ) / C2H3_denom

    C2H3_CH2GL1G = - ( 0.0_pr &
          + k(r111f) * c(sC2H4) &
          + k(r112f) * c(sC2H4)  ) / C2H3_denom

    C2H3_CH3O = - ( 0.0_pr &
          + k(r98b) * c(sCO) &
          + k(r99b) * c(sCO)  ) / C2H3_denom

    C2H3_HCO = - ( 0.0_pr &
          + k(r94b) * c(sCH2O) &
          + k(r95b) * c(sCH2O)  ) / C2H3_denom

    C2H3_CH2CO = - ( 0.0_pr &
          + k(r92b) * c(sOH) &
          + k(r93b) * c(sOH) &
          + k(r108b) * c(sH)  ) / C2H3_denom

    HCO_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r57f)* c(sH) &
             + k(r63f)* m(mM63) &
             + k(r64f)* c(sO2) &
             + k(r65f)* c(sO) &
             + k(r66f)* c(sH) &
             + k(r67f)* c(sOH) &
             + k(r68f)* c(sCH3) &
             + k(r69f)* c(sO) &
             + k(r24b)* c(sH) &
             + k(r29b)* c(sOH) &
             + k(r59b)* c(sOH) &
             + k(r60b)* c(sH2) &
             + k(r61b)* c(sH2O) &
             + k(r62b)* c(sCH4) &
             + k(r87b)* c(sCH3) &
             + k(r94b)* c(sCH2O) &
             + k(r95b)* c(sCH2O)   )

    HCO_num = ( 0.0_pr &
             + k(r59f)* c(sCH2O) * c(sO) &
             + k(r60f)* c(sCH2O) * c(sH) &
             + k(r61f)* c(sCH2O) * c(sOH) &
             + k(r62f)* c(sCH2O) * c(sCH3) &
             + k(r87f)* c(sC2H4) * c(sO) &
             + k(r132f)* c(sC2H4) * c(sO2) &
             + k(r57b)* c(sCH2O) &
             + k(r63b)* c(sCO) * c(sH) * m(mM63) &
             + k(r64b)* c(sCO) * c(sHO2) &
             + k(r65b)* c(sCO) * c(sOH) &
             + k(r66b)* c(sCO) * c(sH2) &
             + k(r67b)* c(sCO) * c(sH2O) &
             + k(r68b)* c(sCH4) * c(sCO) &
             + k(r69b)* c(sCO2) * c(sH)   )

    HCO_ct = HCO_num / HCO_denom

    HCO_C2H2 = - ( 0.0_pr &
          + k(r127f) * c(sHO2) &
          + k(r131f)  * 2.0_pr * c(sO2)  ) / HCO_denom

    HCO_CH2GL1G = - ( 0.0_pr &
          + k(r24f) * c(sO) &
          + k(r29f) * c(sO2)  ) / HCO_denom

    HCO_C2H3 = - ( 0.0_pr &
          + k(r94f) * c(sO2) &
          + k(r95f) * c(sO2)  ) / HCO_denom

    HCO_CH2CO = - ( 0.0_pr &
          + k(r114f)  * 2.0_pr * c(sO)  ) / HCO_denom

    CH2OH_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r49f)* c(sO2) &
             + k(r50f)* c(sO2) &
             + k(r51f)* c(sH) &
             + k(r52f)* c(sOH) &
             + k(r53f)* c(sO) &
             + k(r134f)* c(sCH3) &
             + k(r36b)* c(sH) &
             + k(r43b)* c(sH2) &
             + k(r45b)* c(sOH) &
             + k(r47b)* c(sH2O) &
             + k(r70b)&
             + k(r110b)* c(sCO)   )

    CH2OH_num = ( 0.0_pr &
             + k(r36f)* c(sCH3) * c(sOH) &
             + k(r70f)* c(sCH2O) * c(sH) &
             + k(r49b)* c(sCH2O) * c(sHO2) &
             + k(r50b)* c(sCH2O) * c(sHO2) &
             + k(r51b)* c(sCH2O) * c(sH2) &
             + k(r52b)* c(sCH2O) * c(sH2O) &
             + k(r53b)* c(sCH2O) * c(sOH)   )

    CH2OH_ct = CH2OH_num / CH2OH_denom

    CH2OH_CH3OH = - ( 0.0_pr &
          + k(r43f) * c(sH) &
          + k(r45f) * c(sO) &
          + k(r47f) * c(sOH)  ) / CH2OH_denom

    CH2OH_CH2CO = - ( 0.0_pr &
          + k(r110f) * c(sOH)  ) / CH2OH_denom

    CH3O_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r54f)* c(sO2) &
             + k(r55f)* c(sH) &
             + k(r56f)* c(sCH3) &
             + k(r71f)&
             + k(r128f)* c(sCO) &
             + k(r32b)* c(sO) &
             + k(r37b)* c(sH) &
             + k(r39b)* c(sOH) &
             + k(r42b)* c(sH2) &
             + k(r44b)* c(sOH) &
             + k(r46b)* c(sH2O) &
             + k(r48b)* c(sCH4) &
             + k(r98b)* c(sCO) &
             + k(r99b)* c(sCO)   )

    CH3O_num = ( 0.0_pr &
             + k(r32f)* c(sCH3) * c(sO2) &
             + k(r37f)* c(sCH3) * c(sOH) &
             + k(r39f)* c(sCH3) * c(sHO2) &
             + k(r117f)* cqss(sqssC2H5) * c(sO2) &
             + k(r132f)* c(sC2H4) * c(sO2) &
             + k(r133f)* c(sCH3) * c(sO) * m(mM133) &
             + k(r54b)* c(sCH2O) * c(sHO2) &
             + k(r55b)* c(sCH2O) * c(sH2) &
             + k(r56b)* c(sCH2O) * c(sCH4) &
             + k(r71b)* c(sCH2O) * c(sH) &
             + k(r128b)* c(sCH3) * c(sCO2)   )

    CH3O_ct = CH3O_num / CH3O_denom

    CH3O_CH3OH = - ( 0.0_pr &
          + k(r42f) * c(sH) &
          + k(r44f) * c(sO) &
          + k(r46f) * c(sOH) &
          + k(r48f) * c(sCH3)  ) / CH3O_denom

    CH3O_C2H3 = - ( 0.0_pr &
          + k(r98f) * c(sO2) &
          + k(r99f) * c(sO2)  ) / CH3O_denom

    CH3OH_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r40f)&
             + k(r41f)&
             + k(r42f)* c(sH) &
             + k(r43f)* c(sH) &
             + k(r44f)* c(sO) &
             + k(r45f)* c(sO) &
             + k(r46f)* c(sOH) &
             + k(r47f)* c(sOH) &
             + k(r48f)* c(sCH3)   )

    CH3OH_num = ( 0.0_pr &
             + k(r40b)* c(sCH3) * c(sOH)   )

    CH3OH_ct = CH3OH_num / CH3OH_denom

    CH3OH_CH2GL1G = - ( 0.0_pr &
          + k(r41b) * c(sH2O)  ) / CH3OH_denom

    CH3OH_CH3O = - ( 0.0_pr &
          + k(r42b) * c(sH2) &
          + k(r44b) * c(sOH) &
          + k(r46b) * c(sH2O) &
          + k(r48b) * c(sCH4)  ) / CH3OH_denom

    CH3OH_CH2OH = - ( 0.0_pr &
          + k(r43b) * c(sH2) &
          + k(r45b) * c(sOH) &
          + k(r47b) * c(sH2O)  ) / CH3OH_denom

    CH2GL1G_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r20f)* c(sCH4) &
             + k(r21f)* c(sO2) &
             + k(r22f)* c(sO2) &
             + k(r23f)* c(sO) &
             + k(r24f)* c(sO) &
             + k(r25f)* c(sH2) &
             + k(r26f)* c(sOH) &
             + k(r27f)* c(sCO2) &
             + k(r28f)* c(sH) &
             + k(r29f)* c(sO2) &
             + k(r30f)* c(sO2) &
             + k(r31f)* c(sO) &
             + k(r88f)* c(sCH3) &
             + k(r111f)* c(sC2H4) &
             + k(r112f)* c(sC2H4) &
             + k(r118f)* c(sO) &
             + k(r119f)* c(sOH) &
             + k(r120f)* c(sCO2) &
             + k(r121f)* c(sO) &
             + k(r122f)* c(sCH4) &
             + k(r35b)* c(sH2O) &
             + k(r38b)* c(sH2O) &
             + k(r41b)* c(sH2O) &
             + k(r104b)* c(sCO) &
             + k(r107b)* c(sCO)   )

    CH2GL1G_num = ( 0.0_pr &
             + k(r35f)* c(sCH3) * c(sOH) &
             + k(r38f)* c(sCH3) * c(sOH) &
             + k(r20b) *c(sCH3)** 2.0_pr&
             + k(r22b)* c(sCO) * c(sH2O) &
             + k(r23b)* c(sCO) * c(sH2) &
             + k(r25b)* c(sCH3) * c(sH) &
             + k(r26b)* c(sCH2O) * c(sH) &
             + k(r27b)* c(sCH2O) * c(sCO) &
             + k(r28b)* c(sCH3) &
             + k(r88b)* c(sC2H4) * c(sH) &
             + k(r118b)* c(sCO) * c(sH2) &
             + k(r119b)* c(sCH2O) * c(sH) &
             + k(r120b)* c(sCH2O) * c(sCO) &
             + k(r121b)* c(sCO)  *c(sH)** 2.0_pr&
             + k(r122b) *c(sCH3)** 2.0_pr  )

    CH2GL1G_ct = CH2GL1G_num / CH2GL1G_denom

    CH2GL1G_C2H2 = - ( 0.0_pr &
          + k(r104f) * c(sO)  ) / CH2GL1G_denom

    CH2GL1G_CH3OH = - ( 0.0_pr &
          + k(r41f)  ) / CH2GL1G_denom

    CH2GL1G_HCO = - ( 0.0_pr &
          + k(r24b) * c(sH) &
          + k(r29b) * c(sOH)  ) / CH2GL1G_denom

    CH2GL1G_C2H3 = - ( 0.0_pr &
          + k(r111b) * c(sCH3) &
          + k(r112b) * c(sCH3)  ) / CH2GL1G_denom

    CH2GL1G_CH2CO = - ( 0.0_pr &
          + k(r107f)  ) / CH2GL1G_denom

    C2H2_denom = tiny(1.0_pr) + ( 0.0_pr &
             + k(r89f)* c(sH) &
             + k(r104f)* c(sO) &
             + k(r105f)* c(sOH) &
             + k(r106f)* c(sOH) &
             + k(r113f)* c(sO) &
             + k(r127f)* c(sHO2) &
             + k(r129f)* c(sO2) &
             + k(r131f)* c(sO2) &
             + k(r82b)* c(sH2) * m(mM82) &
             + k(r90b)* c(sHO2) &
             + k(r91b)* c(sHO2) &
             + k(r102b)* c(sH2) &
             + k(r103b)* c(sH2O)   )

    C2H2_num = ( 0.0_pr &
             + k(r82f)* c(sC2H4) * m(mM82) &
             + k(r106b)* c(sCH3) * c(sCO)   )

    C2H2_ct = C2H2_num / C2H2_denom

    C2H2_CH2GL1G = - ( 0.0_pr &
          + k(r104b) * c(sCO)  ) / C2H2_denom

    C2H2_C2H3 = - ( 0.0_pr &
          + k(r90f) * c(sO2) &
          + k(r91f) * c(sO2) &
          + k(r102f) * c(sH) &
          + k(r103f) * c(sOH) &
          + k(r89b)  ) / C2H2_denom

    C2H2_CH2CO = - ( 0.0_pr &
          + k(r105b) * c(sH)  ) / C2H2_denom

    b_i_a =  (1.0_pr) - (C2H2_CH2GL1G) * (CH2GL1G_C2H2)
    b_n_a =  (CH2GL1G_C2H3) - (C2H2_C2H3) * (CH2GL1G_C2H2)
    b_o_a =  (CH2GL1G_CH2CO) - (C2H2_CH2CO) * (CH2GL1G_C2H2)
    b_q_a = CH3OH_CH2GL1G
    b_ad_a = CH3O_C2H3
    b_am_a = CH2OH_CH2CO
    b_ao_a =  (HCO_CH2GL1G) - (C2H2_CH2GL1G) * (HCO_C2H2)
    b_at_a =  (HCO_C2H3) - (C2H2_C2H3) * (HCO_C2H2)
    b_au_a =  (HCO_CH2CO) - (C2H2_CH2CO) * (HCO_C2H2)
    b_aw_a =  (C2H3_CH2GL1G) - (C2H2_CH2GL1G) * (C2H3_C2H2)
    b_bb_a =  (1.0_pr) - (C2H2_C2H3) * (C2H3_C2H2)
    b_bc_a =  (C2H3_CH2CO) - (C2H2_CH2CO) * (C2H3_C2H2)
    b_be_a =  (CH2CO_CH2GL1G) - (C2H2_CH2GL1G) * (CH2CO_C2H2)
    b_bj_a =  (CH2CO_C2H3) - (C2H2_C2H3) * (CH2CO_C2H2)
    b_bk_a =  (1.0_pr) - (C2H2_CH2CO) * (CH2CO_C2H2)
    b_r_b =  (1.0_pr) - (CH2GL1G_CH3OH) * (b_q_a) / (b_i_a)
    b_u_b =  - (CH2GL1G_HCO) * (b_q_a) / (b_i_a)
    b_v_b =  - (b_n_a) * (b_q_a) / (b_i_a)
    b_w_b =  - (b_o_a) * (b_q_a) / (b_i_a)
    b_z_b = CH3O_CH3OH
    b_ad_b = b_ad_a
    b_ah_b = CH2OH_CH3OH
    b_am_b = b_am_a
    b_ap_b =  - (CH2GL1G_CH3OH) * (b_ao_a) / (b_i_a)
    b_as_b =  (1.0_pr) - (CH2GL1G_HCO) * (b_ao_a) / (b_i_a)
    b_at_b =  (b_at_a) - (b_n_a) * (b_ao_a) / (b_i_a)
    b_au_b =  (b_au_a) - (b_o_a) * (b_ao_a) / (b_i_a)
    b_ax_b =  - (CH2GL1G_CH3OH) * (b_aw_a) / (b_i_a)
    b_ba_b =  (C2H3_HCO) - (CH2GL1G_HCO) * (b_aw_a) / (b_i_a)
    b_bb_b =  (b_bb_a) - (b_n_a) * (b_aw_a) / (b_i_a)
    b_bc_b =  (b_bc_a) - (b_o_a) * (b_aw_a) / (b_i_a)
    b_bf_b =  - (CH2GL1G_CH3OH) * (b_be_a) / (b_i_a)
    b_bi_b =  - (CH2GL1G_HCO) * (b_be_a) / (b_i_a)
    b_bj_b =  (b_bj_a) - (b_n_a) * (b_be_a) / (b_i_a)
    b_bk_b =  (b_bk_a) - (b_o_a) * (b_be_a) / (b_i_a)
    b_aa_c =  (1.0_pr) - (CH3OH_CH3O) * (b_z_b) / (b_r_b)
    b_ab_c =  - (CH3OH_CH2OH) * (b_z_b) / (b_r_b)
    b_ai_c =  - (CH3OH_CH3O) * (b_ah_b) / (b_r_b)
    b_aj_c =  (1.0_pr) - (CH3OH_CH2OH) * (b_ah_b) / (b_r_b)
    b_aq_c =  - (CH3OH_CH3O) * (b_ap_b) / (b_r_b)
    b_ar_c =  - (CH3OH_CH2OH) * (b_ap_b) / (b_r_b)
    b_ay_c =  (C2H3_CH3O) - (CH3OH_CH3O) * (b_ax_b) / (b_r_b)
    b_bz_c =  - (CH3OH_CH2OH) * (b_ax_b) / (b_r_b)
    b_bg_c =  - (CH3OH_CH3O) * (b_bf_b) / (b_r_b)
    b_bh_c =  (CH2CO_CH2OH) - (CH3OH_CH2OH) * (b_bf_b) / (b_r_b)
    b_al_d =  - (b_ad_b) * (b_ai_c) / (b_aa_c)
    b_at_d =  (b_at_b) - (b_ad_b) * (b_aq_c) / (b_aa_c)
    b_bb_d =  (b_bb_b) - (b_ad_b) * (b_ay_c) / (b_aa_c)
    b_bj_d =  (b_bj_b) - (b_ad_b) * (b_bg_c) / (b_aa_c)
    b_au_e =  (b_au_b) - (b_am_b) * (b_ar_c) / (b_aj_c)
    b_bc_e =  (b_bc_b) - (b_am_b) * (b_bz_c) / (b_aj_c)
    b_bk_e =  (b_bk_b) - (b_am_b) * (b_bh_c) / (b_aj_c)
    b_bb_f =  (b_bb_d) - (b_at_d) * (b_ba_b) / (b_as_b)
    b_bc_f =  (b_bc_e) - (b_au_e) * (b_ba_b) / (b_as_b)
    b_bj_f =  (b_bj_d) - (b_at_d) * (b_bi_b) / (b_as_b)
    b_bk_f =  (b_bk_e) - (b_au_e) * (b_bi_b) / (b_as_b)
    b_bk_g =  (b_bk_f) - (b_bc_f) * (b_bj_f) / (b_bb_f)
    B_A_A =  (CH2GL1G_ct) - (C2H2_ct) * (CH2GL1G_C2H2)
    B_B_A = CH3OH_ct
    B_C_A = CH3O_ct
    B_D_A = CH2OH_ct
    B_E_A =  (HCO_ct) - (C2H2_ct) * (HCO_C2H2)
    B_F_A =  (C2H3_ct) - (C2H2_ct) * (C2H3_C2H2)
    B_G_A =  (CH2CO_ct) - (C2H2_ct) * (CH2CO_C2H2)
    B_B_B =  (B_B_A) - (B_A_A) * (b_q_a) / (b_i_a)
    B_C_B = B_C_A
    B_D_B = B_D_A
    B_E_B =  (B_E_A) - (B_A_A) * (b_ao_a) / (b_i_a)
    B_F_B =  (B_F_A) - (B_A_A) * (b_aw_a) / (b_i_a)
    B_G_B =  (B_G_A) - (B_A_A) * (b_be_a) / (b_i_a)
    B_C_C =  (B_C_B) - (B_B_B) * (b_z_b) / (b_r_b)
    B_D_C =  (B_D_B) - (B_B_B) * (b_ah_b) / (b_r_b)
    B_E_C =  (B_E_B) - (B_B_B) * (b_ap_b) / (b_r_b)
    B_F_C =  (B_F_B) - (B_B_B) * (b_ax_b) / (b_r_b)
    B_G_C =  (B_G_B) - (B_B_B) * (b_bf_b) / (b_r_b)
    B_D_D =  (B_D_C) - (B_C_C) * (b_ai_c) / (b_aa_c)
    B_E_D =  (B_E_C) - (B_C_C) * (b_aq_c) / (b_aa_c)
    B_F_D =  (B_F_C) - (B_C_C) * (b_ay_c) / (b_aa_c)
    B_G_D =  (B_G_C) - (B_C_C) * (b_bg_c) / (b_aa_c)
    B_E_E =  (B_E_D) - (B_D_D) * (b_ar_c) / (b_aj_c)
    B_F_E =  (B_F_D) - (B_D_D) * (b_bz_c) / (b_aj_c)
    B_G_E =  (B_G_D) - (B_D_D) * (b_bh_c) / (b_aj_c)
    B_F_F =  (B_F_E) - (B_E_E) * (b_ba_b) / (b_as_b)
    B_G_F =  (B_G_E) - (B_E_E) * (b_bi_b) / (b_as_b)
    B_G_G =  (B_G_F) - (B_F_F) * (b_bj_f) / (b_bb_f)

    cqss(sqssCH2CO) = ( B_G_G ) / ( b_bk_g )  

    cqss(sqssC2H3) = (B_F_F - (b_bc_f) * cqss(sqssCH2CO)) / (b_bb_f)  

    cqss(sqssHCO) = (B_E_E - (b_au_e) * cqss(sqssCH2CO) - (b_at_d) &
                 * cqss(sqssC2H3)) / (b_as_b)  

    cqss(sqssCH2OH) = (B_D_D - (b_am_b) * cqss(sqssCH2CO) - (b_al_d) &
                 * cqss(sqssC2H3)) / (b_aj_c)  

    cqss(sqssCH3O) = (B_C_C - (b_ad_b) * cqss(sqssC2H3) - (b_ab_c) &
                 * cqss(sqssCH2OH)) / (b_aa_c)  

    cqss(sqssCH3OH) = (B_B_B - (b_w_b) * cqss(sqssCH2CO) - (b_v_b) &
                 * cqss(sqssC2H3) - (b_u_b) * cqss(sqssHCO) &
                 - (CH3OH_CH2OH) * cqss(sqssCH2OH) - (CH3OH_CH3O) &
                 * cqss(sqssCH3O)) / (b_r_b)  

    cqss(sqssCH2GL1G) = (B_A_A - (b_o_a) * cqss(sqssCH2CO) - (b_n_a) &
                 * cqss(sqssC2H3) - (CH2GL1G_HCO) * cqss(sqssHCO) &
                 - (CH2GL1G_CH3OH) * cqss(sqssCH3OH)) / (b_i_a)  

    cqss(sqssC2H2) = C2H2_ct - (C2H2_CH2CO) * cqss(sqssCH2CO) - (C2H2_C2H3) &
                 * cqss(sqssC2H3) - (C2H2_CH2GL1G) * cqss(sqssCH2GL1G)  

    cqss = max(cqss, tiny(1.0_pr))
    cqss = min(cqss, 1e03_pr)

    ! Necessary for very low concentration variations
    ! Needs to be integrated only for Cantera
    do index=1,nqss
      if (cqss(index) /= cqss(index)) then
        cqss(index) = tiny(1.0_pr)
      end if
    end do

    return
  end subroutine get_qss


  ! ----------------------------------------------- !
  ! Mass fractions to concentrations                !
  ! ----------------------------------------------- !
  subroutine y2c(y, W_sp, P, T, c)
    implicit none

    real(pr),dimension(nspec) :: W_sp
    real(pr),dimension(nspec) :: c, y
    real(pr) :: rho, P, T, inv_W_g

    integer :: k
    
    ! Gas molecular weight inverse
    inv_W_g = 0.0_pr
    do k =1, nspec
      inv_W_g = inv_W_g + y(k) / W_sp(k)
    end do

    ! Gas density
    rho = P / (Rcst * inv_W_g * T)

    ! Conversion
    c = y * rho / W_sp

    ! Concentrations clipping
    !do  k = 1, nspec
    !   if (c(k)<1.0e-20_pr) c(k) = 0.0_pr
    !end do

        return
    end subroutine y2c

end module mod_customkinetics
! ----------------------------------------------- !
! Cantera routine                                 !
! ----------------------------------------------- !
subroutine customkinetics(P, T, y, wdot)

  use mod_customkinetics
  implicit none

  real(pr), dimension(nspec) :: y, c, wdot, cdot
  real(pr), dimension(nqss) :: cqss
  real(pr), dimension(nreac + nreac_reverse) :: w,k
  real(pr), dimension(nTB + nFO) :: M
  real(pr) :: P, T, rho

  ! Convert to concentrations
  call y2c(y, W_sp, P, T, c)

  ! Evaluate QSS concentrations and reaction rates
  call get_thirdbodies(M,c)

  call get_rate_coefficients(k, M, T, P)
  call get_qss(cqss, c, k, M)

  call get_reaction_rates(w, k, M, c, cqss)

  ! Evaluate production rates
  call get_production_rates(wdot,w)


  return
end subroutine customkinetics

